:root{--c-bg: #f5f6f8;--c-surface: #ffffff;--c-surface-muted: #f1f3f5;--c-surface-overlay: rgba(255, 255, 255, .88);--c-text: #212529;--c-text-muted: #6c757d;--c-border: #dfe3e6;--c-border-strong: #c3c9d0;--c-gridline: #e9ecef;--c-danger: #dc3545;--c-warning: #ffc107;--c-accent: #4a90e2;--c-accent-hover: #3b78bb;--c-accent-light: #63a9fd;--c-accent-rgb: 74, 144, 226;--space-0: 0rem;--space-005: .05rem;--space-010: .1rem;--space-015: .15rem;--space-020: .2rem;--space-025: .25rem;--space-030: .3rem;--space-035: .35rem;--space-040: .4rem;--space-045: .45rem;--space-050: .5rem;--space-055: .55rem;--space-060: .6rem;--space-065: .65rem;--space-070: .7rem;--space-075: .75rem;--space-080: .8rem;--space-085: .85rem;--space-090: .9rem;--space-095: .95rem;--space-100: 1rem;--space-150: 1.5rem;--space-200: 2rem;--space-1: .125rem;--space-2: .25rem;--space-3: .375rem;--space-4: .5rem;--space-5: .75rem;--app-padding: var(--space-025);--note-size: 1rem;--note-margin: var(--space-1);--slider-thumb-size: 20px;--slider-thumb-border: 2px;--slider-thumb-total: calc(var(--slider-thumb-size) + (var(--slider-thumb-border) * 2));--slider-track-thickness: calc(var(--slider-thumb-size) / 2);--border-radius-sm: 3px;--border-radius-md: 6px;--box-shadow-sm: 0 1px 2px rgba(15, 23, 42, .06);--box-shadow-md: 0 3px 6px rgba(15, 23, 42, .12);--main-font: "Atkinson Hyperlegible", Arial, sans-serif;--font-size-sm: .875rem;--font-size-base: 1rem;--font-size-lg: 1.125rem}@font-face{font-family:Atkinson Hyperlegible;src:url(/Student-Notation/assets/AtkinsonHyperlegibleNext-Regular-DOJsAlq1.otf) format("opentype");font-weight:400;font-style:normal}*,*:before,*:after{box-sizing:border-box}html,body{margin:0;padding:0;height:100%;width:100%;overflow-x:hidden;overflow-y:hidden;font-family:var(--main-font);background-color:var(--c-bg);color:var(--c-text);display:flex}button{background-color:var(--c-accent);color:var(--c-surface);border:none;border-radius:var(--border-radius-md);padding:var(--space-025) var(--space-050);font-family:var(--main-font);font-size:14px;cursor:pointer;transition:background-color .2s ease,opacity .2s ease}button:hover,button:focus{background-color:var(--c-accent-hover);outline:none}button:disabled{background-color:var(--c-border);opacity:.7;cursor:not-allowed}*{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}*::selection{background:transparent}*::-moz-selection{background:transparent}:root{font-size:125%}body{font-size:var(--font-size-base)}button{font-size:var(--font-size-sm)}.slider-label{font-size:var(--font-size-base)}.tempo-input{font-size:var(--font-size-sm)}.app-title{font-size:var(--font-size-base)}.tonic-sign-button{font-size:var(--font-size-lg)}#app-loading-screen{position:fixed;top:0;left:0;width:100vw;height:100dvh;background:linear-gradient(135deg,#1a1a2e,#16213e,#0f3460);display:flex;align-items:center;justify-content:center;z-index:99999;opacity:1;transition:opacity .6s cubic-bezier(.4,0,.2,1)}#app-loading-screen.fade-out{opacity:0;pointer-events:none}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:2rem;max-width:400px}.loading-logo{width:120px;height:120px;margin-bottom:2rem;animation:float 3s ease-in-out infinite}@keyframes float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.logo-svg{width:100%;height:100%;filter:drop-shadow(0 0 20px rgba(168,140,243,.4))}.logo-circle{fill:none;stroke:#a88cf3;stroke-width:2;stroke-dasharray:283;stroke-dashoffset:283;animation:drawCircle 2s ease-in-out forwards,pulse 2s ease-in-out 2s infinite;transform-origin:center}.logo-path{fill:none;stroke:#4a90e2;stroke-width:3;stroke-linecap:round;stroke-dasharray:100;stroke-dashoffset:100;animation:drawPath 1.5s ease-in-out .5s forwards}@keyframes drawCircle{to{stroke-dashoffset:0}}@keyframes drawPath{to{stroke-dashoffset:0}}@keyframes pulse{0%,to{opacity:1;stroke-width:2}50%{opacity:.6;stroke-width:2.5}}.loading-title{font-family:Atkinson Hyperlegible,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;font-size:2rem;font-weight:400;color:#fff;margin:0 0 2.5rem;letter-spacing:.5px;opacity:0;animation:fadeInUp .8s ease-out .3s forwards}@keyframes fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.loading-progress-container{width:100%;margin-bottom:1.5rem;opacity:0;animation:fadeInUp .8s ease-out .6s forwards}.loading-progress-bar{width:100%;height:4px;background-color:#ffffff1a;border-radius:2px;overflow:hidden;margin-bottom:.75rem;box-shadow:inset 0 1px 3px #0000004d}.loading-progress-fill{height:100%;width:0%;background:linear-gradient(90deg,#4a90e2,#a88cf3);border-radius:2px;transition:width .3s cubic-bezier(.4,0,.2,1);box-shadow:0 0 10px #4a90e280;position:relative;overflow:hidden}.loading-progress-fill:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:shimmer 2s infinite}@keyframes shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.loading-progress-text{font-family:Atkinson Hyperlegible,monospace;font-size:.875rem;color:#ffffffb3;letter-spacing:1px}.loading-status{font-family:Atkinson Hyperlegible,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;font-size:.875rem;color:#fff9;opacity:0;animation:fadeInUp .8s ease-out .9s forwards;min-height:1.5rem;transition:color .3s ease}#app-loading-screen.error .loading-status{color:#f44;font-weight:500}#app-loading-screen.error .loading-progress-fill{background:linear-gradient(90deg,#f44,#c00);box-shadow:0 0 10px #ff444480}@media (max-width: 768px){.loading-container{max-width:300px}.loading-logo{width:90px;height:90px}.loading-title{font-size:1.5rem}}@media (prefers-reduced-motion: reduce){#app-loading-screen,.loading-logo,.logo-circle,.logo-path,.loading-title,.loading-progress-container,.loading-status,.loading-progress-fill{animation:none!important;transition:none!important}.loading-title,.loading-progress-container,.loading-status{opacity:1}.logo-circle,.logo-path{stroke-dashoffset:0}}#app-container{display:flex;flex-direction:column;flex:1;min-height:0;width:100vw;overflow-x:visible}#canvas-container{height:80dvh;display:flex;flex-direction:column;min-height:0;width:fit-content;min-width:100%;overflow-x:visible;padding:var(--space-2);padding-top:0;padding-bottom:0;position:relative;z-index:1;background-color:var(--c-surface-muted)}#canvas-content{display:flex;flex-direction:row;flex:1;min-width:fit-content;overflow-x:visible;min-height:0}#toolbar{height:20dvh;min-height:170px;width:100%;display:flex;flex-direction:row;gap:var(--space-2);align-items:stretch;padding:var(--space-2);padding-bottom:0;border:none;background-color:transparent;box-shadow:none;flex-shrink:0;margin-bottom:0;position:relative;z-index:2;overflow-x:auto;overflow-y:hidden}#toolbar-primary,#toolbar-secondary{display:flex;border:1px solid var(--c-border);border-radius:var(--border-radius-md);background-color:var(--c-surface)}#toolbar-primary{flex:0 0 auto;padding:var(--space-025);height:100%;max-height:100%;overflow:hidden}.primary-toolbar-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));grid-template-rows:4fr 1fr;grid-template-areas:"actions notebank" "playback playback";gap:var(--space-020);height:100%}.primary-toolbar-cell{min-width:0;min-height:0}.primary-toolbar-actions{grid-area:actions;display:grid;grid-template-columns:repeat(2,minmax(0,1fr));grid-template-rows:repeat(4,minmax(0,1fr));gap:var(--space-020);align-content:stretch;align-items:stretch}.primary-toolbar-actions .toolkit-icon-button,.primary-toolbar-actions #volume-control-wrapper{width:100%;height:100%;min-height:0}.primary-toolbar-actions #volume-control-wrapper{display:flex;align-items:center;justify-content:center;position:relative}.primary-toolbar-actions .toolkit-icon-button{aspect-ratio:1 / 1}.primary-toolbar-actions .toolkit-icon-button img{width:100%;height:100%}.primary-toolbar-notebank{grid-area:notebank;display:flex;justify-content:flex-end;align-items:stretch}.primary-toolbar-notebank #note-bank-container{height:100%;max-width:100%}.primary-toolbar-playback{grid-area:playback;display:flex;align-items:center;gap:var(--space-020);justify-content:center;overflow:hidden}.primary-toolbar-playback .toolkit-icon-button{height:100%;width:auto;aspect-ratio:1 / 1;flex:0 0 auto;max-width:25%}#toolbar-secondary{flex:0 1 auto;height:100%;min-height:0;overflow:hidden;display:flex;min-width:fit-content}.tab-sidebar{flex:0 0 fit-content;display:flex;flex-direction:column;background-color:var(--c-surface-muted);border-right:1px solid var(--c-border-strong)}.tab-content{flex:1;padding:0;background-color:transparent;overflow-x:auto;overflow-y:hidden;min-width:0;height:100%}.tab-content:has(.dropdown-container.open){overflow:visible}.tab-content.dropdown-open{overflow:visible}#toolbar-secondary:has(.dropdown-container.open){overflow:visible}#toolbar-secondary.dropdown-open{overflow:visible}.tab-panel{display:none;height:100%;align-items:stretch}.tab-panel.active{display:flex;gap:0;min-height:0}.control-section{flex:0 1 fit-content;padding:0;background-color:transparent;border-right:none;display:flex;flex-direction:column;min-width:fit-content;width:fit-content;border-radius:0;min-height:0;max-height:100%}.preset-effects-container{align-items:flex-start;justify-content:flex-start;flex:0 0 auto;width:fit-content;max-height:100%;overflow:hidden}.control-section h4{margin:0 0 var(--space-2) 0;color:var(--c-text-muted);font-size:.9em;text-transform:uppercase;letter-spacing:.5px;flex-shrink:0;width:100%;text-align:center}.rhythm-structure-container{display:flex;flex-direction:column;gap:var(--space-3);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-sm);padding:var(--space-015)}.control-subsection{display:flex;flex-direction:column}.control-subsection h4{margin:0;color:var(--c-text-muted);font-size:.9em;text-transform:uppercase;letter-spacing:.5px;flex-shrink:0;width:100%}.macrobeat-adjust-group,.toggle-button-group{display:flex;gap:var(--space-2);justify-content:center}.modulation-container{display:flex;flex-direction:column;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-sm);padding:var(--space-015)}.modulation-controls{display:flex;gap:var(--space-2);align-items:flex-start}.rhythm-stamps-container{display:flex;flex-direction:column;height:auto;gap:var(--space-1)}.rhythm-tab-sidebar{flex:0 0 auto;display:flex;flex-direction:row;gap:0;background-color:transparent;border-right:none;border-bottom:1px solid var(--c-border);padding:0}.rhythm-tab-content{flex:1;padding:var(--space-015);background-color:var(--c-surface);overflow:auto;min-width:0;border:1px solid var(--c-border);border-top:none;border-radius:0 0 var(--border-radius-md) var(--border-radius-md);box-shadow:var(--box-shadow-sm)}.rhythm-tab-panel{display:none;padding:0;height:100%}.rhythm-tab-panel.active{display:flex;flex-direction:row;gap:var(--space-1);height:100%;max-height:100%}.stamps-toolbar-container{display:flex;justify-content:center;padding-left:.3rem}.stamps-grid{display:flex;flex-direction:column}.stamps-row{display:grid;gap:var(--space-3);justify-items:center}.stamps-row-1{grid-template-columns:repeat(4,1fr)}.stamps-row-2{grid-template-columns:repeat(6,1fr);padding-top:var(--space-3)}.stamps-row-3{grid-template-columns:repeat(5,1fr);padding-top:var(--space-3)}.triplets-toolbar-container{display:flex;justify-content:center}.triplets-main-container{display:flex;flex-direction:column;align-items:flex-start}.triplets-sections{display:flex;flex-direction:column;gap:var(--space-2)}.triplets-section{display:flex;flex-direction:column;gap:var(--space-2);align-items:flex-start}.triplets-grid{display:grid;grid-template-columns:repeat(7,1fr);justify-items:center;gap:var(--space-3)}.triplets-quarter-row{grid-template-columns:repeat(3,1fr);margin-bottom:var(--space-2)}.triplets-quarter-row:nth-child(2){grid-template-columns:repeat(4,1fr);margin-bottom:0}#canvas-macrobeat-tools{position:relative;display:flex;align-items:center;gap:var(--space-2);padding:var(--space-1) var(--space-2);min-height:56px;pointer-events:none;z-index:2}#canvas-macrobeat-tools>*{pointer-events:auto}.macrobeat-left-controls{display:flex;align-items:center;gap:var(--space-2);flex:0 0 auto}.macrobeat-accidentals{display:inline-flex;align-items:center;gap:var(--space-2);padding:var(--space-020) var(--space-035);border:1px solid var(--c-border);border-radius:var(--border-radius-md);background-color:var(--c-surface);box-shadow:var(--box-shadow-sm)}.macrobeat-accidentals .accidental-button{background:none;border:none;color:var(--c-text);font-size:var(--font-size-base);padding:var(--space-020) var(--space-035);border-radius:var(--border-radius-sm);cursor:pointer}.macrobeat-accidentals .accidental-button.active{background-color:var(--c-accent);color:var(--c-surface)}#beat-line-button-layer{position:relative;flex:1 1 auto;min-height:56px;pointer-events:none}#beat-line-button-layer .rhythm-ui-button,#beat-line-button-layer .time-signature-label{pointer-events:auto}#beat-line-button-layer .rhythm-ui-button{border:1px solid var(--c-border);background-color:var(--c-surface);border-radius:var(--border-radius-sm);padding:var(--space-015) var(--space-040);font-size:.85rem;font-weight:600;color:var(--c-text);box-shadow:var(--box-shadow-sm);transition:background-color .2s ease}#beat-line-button-layer .rhythm-ui-button:hover{background-color:var(--c-surface-muted)}#beat-line-button-layer .rhythm-ui-button--boundary{padding:var(--space-010) var(--space-030);font-size:.75rem}#beat-line-button-layer .time-signature-label{top:4px;padding:var(--space-010) var(--space-040);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);background-color:var(--c-surface-overlay);color:var(--c-text-muted);font-size:.75rem;font-weight:600;letter-spacing:.05em;box-shadow:var(--box-shadow-sm)}#beat-line-button-layer .time-signature-label.anacrusis{border-color:var(--c-warning);color:var(--c-warning)}#pitch-grid-wrapper{width:fit-content;min-width:fit-content;display:flex;flex-direction:column;flex:1;min-height:200px;overflow-x:hidden;overflow-y:hidden;position:relative}#pitch-grid-container{flex:1;position:relative;width:fit-content;overflow-x:visible;overflow-y:hidden;min-height:0;background-color:var(--c-surface)}#pitch-canvas-wrapper{position:relative;width:100%;height:100%}#notation-grid,#playhead-canvas,#hover-canvas,#pitch-paint-canvas{position:absolute;top:0;left:0;display:block}#playhead-canvas,#hover-canvas,#drum-hover-canvas,#pitch-paint-canvas{pointer-events:none;cursor:crosshair}#drum-grid-wrapper{flex:0 0 auto;width:fit-content;min-height:90px;overflow:hidden;position:relative;background-color:var(--c-surface);border-radius:0 0 var(--border-radius-md) var(--border-radius-md)}#drum-grid,#drum-playhead-canvas,#drum-hover-canvas{display:block;position:absolute;top:0;left:0}#drum-playhead-canvas,#drum-hover-canvas{pointer-events:none}#sidebar{position:fixed;top:0;left:0;width:250px;height:100%;background-color:var(--c-surface-overlay);border-right:1px solid var(--c-border-strong);box-shadow:var(--box-shadow-md);padding:var(--space-035);display:flex;flex-direction:column;gap:var(--space-035);z-index:2000;transform:translate(-100%);transition:transform .3s ease-in-out;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}body.sidebar-open #sidebar{transform:translate(0)}.sidebar-container{border:1px solid var(--c-border);border-radius:var(--border-radius-md);padding:var(--space-025);background-color:var(--c-surface)}.sidebar-container .app-title{text-align:center;font-weight:700;line-height:1.2;color:var(--c-text-muted)}.sidebar-button{display:flex;align-items:center;gap:var(--space-025);width:100%;padding:var(--space-025);text-align:left;margin-bottom:var(--space-025)}.sidebar-button:last-child{margin-bottom:0}.sidebar-button img{width:20px;height:20px;flex-shrink:0}#sidebar-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;z-index:1999;opacity:0;visibility:hidden;transition:opacity .3s ease-in-out,visibility .3s ease-in-out}body.sidebar-open #sidebar-overlay{opacity:1;visibility:visible}#volume-control-wrapper{position:relative}#volume-popup{position:absolute;top:50%;left:100%;transform:translateY(-50%);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);padding:var(--space-025) var(--space-035);margin-left:var(--space-025);box-shadow:var(--box-shadow-sm);z-index:1001;visibility:hidden;opacity:0;transition:opacity .2s,visibility .2s}#volume-popup.visible{visibility:visible;opacity:1}input[type=range][orient=vertical]{-moz-appearance:none;appearance:none;-webkit-appearance:none;writing-mode:initial;direction:initial;width:120px;height:8px;padding:5px 0}.sidebar-section-title{margin:0 0 var(--space-025) 0;color:var(--c-text-muted);font-size:.9em;text-transform:uppercase;letter-spacing:.5px;font-weight:600;text-align:center}.sidebar-paint-controls{display:flex;flex-direction:column;gap:var(--space-035)}.sidebar-paint-controls .paint-control-group{display:flex;flex-direction:column;gap:var(--space-015)}.sidebar-paint-controls .paint-control-group label{font-size:.9rem;font-weight:500;color:var(--c-text-muted);margin-bottom:var(--space-015)}.paint-control-select{width:100%;padding:var(--space-015) var(--space-025);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);background-color:var(--c-surface);color:var(--c-text);font-family:var(--main-font);font-size:.9rem;cursor:pointer}.paint-control-select:focus{outline:none;border-color:var(--c-accent);box-shadow:0 0 0 2px rgba(var(--c-accent-rgb),.2)}.paint-control-select:hover{border-color:var(--c-text-muted)}.sidebar-viz-controls{display:flex;flex-direction:column;gap:var(--space-035)}.sidebar-control-group{display:flex;flex-direction:column;gap:var(--space-015)}.sidebar-control-group label{font-size:.85rem;font-weight:500;color:var(--c-text-muted);margin-bottom:var(--space-015)}.sidebar-range-input{width:100%;height:6px;background:var(--c-gridline);border-radius:3px;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none;transition:background .2s ease}.sidebar-range-input::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:16px;height:16px;background:var(--c-accent);border-radius:50%;cursor:pointer;border:2px solid var(--c-surface);box-shadow:0 2px 4px #0003;transition:all .2s ease}.sidebar-range-input::-webkit-slider-thumb:hover{transform:scale(1.1);box-shadow:0 2px 6px #0000004d}.sidebar-range-input::-moz-range-thumb{width:16px;height:16px;background:var(--c-accent);border-radius:50%;cursor:pointer;border:2px solid var(--c-surface);box-shadow:0 2px 4px #0003;transition:all .2s ease}.sidebar-range-input::-moz-range-thumb:hover{transform:scale(1.1);box-shadow:0 2px 6px #0000004d}.sidebar-value-display{font-size:.8rem;font-weight:600;color:var(--c-accent);text-align:center;min-height:1.2em;display:flex;align-items:center;justify-content:center}.sidebar-toggle-button{width:100%;padding:var(--space-025) var(--space-035);background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);font-family:var(--main-font);font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s ease;text-align:center}.sidebar-toggle-button:hover{background-color:var(--c-border);border-color:var(--c-text-muted)}.sidebar-toggle-button:focus{outline:none;border-color:var(--c-accent);box-shadow:0 0 0 2px rgba(var(--c-accent-rgb),.2)}.sidebar-toggle-button.extended{background-color:var(--c-accent)!important;color:var(--c-surface)!important;border-color:var(--c-accent)!important}.mic-device-selector{width:100%;padding:var(--space-015) var(--space-025);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);background-color:var(--c-surface);color:var(--c-text);font-family:var(--main-font);font-size:.9rem}.mic-device-selector:focus{outline:none;border-color:var(--c-accent);box-shadow:0 0 0 2px rgba(var(--c-accent-rgb),.2)}.keyboard-shortcuts-container{margin-top:1rem;padding-top:.75rem;border-top:1px solid var(--c-border-light, #e8ecf0)}.keyboard-shortcuts-container h4{margin-bottom:.5rem;font-size:.875rem;font-weight:600;color:var(--c-text-muted, #6c757d)}.shortcuts-list{display:flex;flex-direction:column;gap:.25rem}.shortcut-item{display:flex;justify-content:space-between;align-items:center;padding:.125rem 0;font-size:.75rem}.shortcut-key{font-family:SF Mono,Monaco,Cascadia Code,Roboto Mono,Consolas,Courier New,monospace;background-color:var(--c-surface, #f8f9fa);color:var(--c-text, #212529);padding:.125rem .25rem;border-radius:3px;border:1px solid var(--c-border, #dee2e6);font-weight:500;min-width:3rem;text-align:center;white-space:nowrap}.shortcut-desc{color:var(--c-text-muted, #6c757d);font-weight:400;text-align:right;flex:1;margin-left:.5rem}@media (prefers-color-scheme: dark){.keyboard-shortcuts-container{border-top-color:var(--c-border-dark, #495057)}.keyboard-shortcuts-container h4{color:var(--c-text-dark, #e2e8f0)}.shortcut-key{background-color:var(--c-surface-dark, #2d3748);color:var(--c-text-dark, #e2e8f0);border-color:var(--c-border-dark, #4a5568)}.shortcut-desc{color:var(--c-text-muted-dark, #a0aec0)}}@media (max-width: 768px){.shortcut-item{font-size:.7rem}.shortcut-key{font-size:.65rem;padding:.1rem .2rem;min-width:2.5rem}}#print-preview-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0009;display:flex;justify-content:center;align-items:center;z-index:1000;opacity:1;transition:opacity .3s ease}#print-preview-overlay.hidden{opacity:0;pointer-events:none}#print-preview-modal{background-color:var(--c-surface);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-md);width:80vw;height:80dvh;display:flex;flex-direction:column}.print-preview-header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;border-bottom:1px solid var(--c-border);flex-shrink:0}.print-preview-header h2{margin:0;font-size:18px}.print-preview-content{flex-grow:1;display:flex;gap:20px;padding:20px;min-height:0}.print-preview-canvas-wrapper{flex-grow:1;border:1px dashed var(--c-border);background-color:var(--c-bg);overflow:auto;padding:10px}#print-preview-canvas{display:block;background-color:#fff}.print-preview-options{flex-basis:280px;flex-shrink:0;display:flex;flex-direction:column;gap:15px}.print-option-row{display:grid;grid-template-columns:90px 40px 1fr;align-items:center;gap:10px}.print-option-row label{font-weight:700}.print-option-row span{font-family:monospace;font-size:12px}.print-preview-options h3{margin-top:10px;margin-bottom:5px;border-bottom:1px solid var(--c-gridline);padding-bottom:5px}.print-preview-footer{padding:10px 20px;border-top:1px solid var(--c-border);text-align:right;flex-shrink:0}.close-button{background:none;border:none;font-size:24px;line-height:1;padding:0 5px;color:var(--c-text-muted);cursor:pointer}.confirm-button{background-color:#28a745;font-weight:700}.confirm-button:hover{background-color:#218838}.toggle-button{width:100%;grid-column:2 / -1}.toggle-button.active{background-color:var(--c-accent)}.toggle-button:not(.active){background-color:var(--c-gridline);color:var(--c-text)}#notification-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;display:flex;justify-content:center;align-items:center;z-index:2000;opacity:0;visibility:hidden;transition:opacity .3s ease,visibility .3s ease}#notification-overlay.visible{opacity:1;visibility:visible}.notification-modal{background-color:var(--c-surface);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-md);max-width:400px;width:90%;padding:var(--space-050);text-align:center;transform:scale(.9) translateY(20px);transition:transform .3s ease}#notification-overlay.visible .notification-modal{transform:scale(1) translateY(0)}.notification-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-035)}.notification-title{font-size:var(--font-size-lg);font-weight:600;color:var(--c-text);margin:0}.notification-close{background:none;border:none;font-size:20px;line-height:1;padding:var(--space-015);color:var(--c-text-muted);cursor:pointer;border-radius:var(--border-radius-sm);transition:background-color .2s ease}.notification-close:hover{background-color:var(--c-gridline)}.notification-message{font-size:var(--font-size-base);color:var(--c-text);margin-bottom:var(--space-050);line-height:1.5}.notification-actions{display:flex;gap:var(--space-025);justify-content:center}.notification-button{background-color:var(--c-accent);color:var(--c-surface);border:none;border-radius:var(--border-radius-md);padding:var(--space-025) var(--space-050);font-family:var(--main-font);font-size:var(--font-size-sm);font-weight:500;cursor:pointer;transition:background-color .2s ease}.notification-button:hover{background-color:var(--c-accent-hover)}.notification-button.secondary{background-color:var(--c-gridline);color:var(--c-text)}.notification-button.secondary:hover{background-color:var(--c-border)}@media print{body>#app-container,body>#print-preview-overlay{display:none!important}#print-staging-area{display:block!important;visibility:visible!important;margin:0;padding:0}#print-staging-area img{display:block!important;visibility:visible!important;width:100%;height:auto}}#print-staging-area{display:none}:root{--rhythm-ui-button-size: 1.25rem;--rhythm-ui-button-font-size: var(--font-size-sm)}#canvas-macrobeat-tools{position:relative;display:flex;flex-direction:column;flex-shrink:0;margin-block-end:var(--space-015);gap:var(--space-015)}#canvas-macrobeat-tools #accidental-controls-container-v2{position:absolute;right:100%;top:50%;transform:translateY(-50%);z-index:10;margin-right:var(--space-015)}#beat-line-ui{position:relative;display:flex;flex-direction:column;gap:var(--space-015);min-height:2.25rem}#beat-line-button-layer{position:relative;min-height:2.25rem;width:100%}.rhythm-ui-button{--rhythm-ui-button-width: var(--rhythm-ui-button-size);--rhythm-ui-button-height: var(--rhythm-ui-button-size);--rhythm-ui-button-radius: 999px;background-color:var(--c-surface-overlay);color:var(--c-text);border:1px solid var(--c-border);width:var(--rhythm-ui-button-width);height:var(--rhythm-ui-button-height);border-radius:var(--rhythm-ui-button-radius);font-size:var(--rhythm-ui-button-font-size);font-weight:600;display:inline-flex;align-items:center;justify-content:center;padding:0;line-height:1;position:absolute;transform:translate(-50%);z-index:10;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);transition:background-color .2s ease,border-color .2s ease,color .2s ease,transform .1s ease}.rhythm-ui-button:hover,.rhythm-ui-button:focus-visible{background-color:var(--c-surface);border-color:var(--c-text);color:var(--c-text);outline:none}.rhythm-ui-button:active{transform:translate(-50%) scale(.95)}.rhythm-ui-button--group{background-color:var(--c-accent-light);border-color:rgba(var(--c-accent-rgb),.55);color:var(--c-surface);box-shadow:var(--box-shadow-sm)}.rhythm-ui-button--group:hover,.rhythm-ui-button--group:focus-visible{background-color:var(--c-accent);border-color:var(--c-accent-hover);color:var(--c-surface)}.rhythm-ui-button--boundary{--rhythm-ui-button-width: auto;--rhythm-ui-button-height: calc(var(--rhythm-ui-button-size) * .85);--rhythm-ui-button-radius: var(--border-radius-sm);padding-inline:var(--space-025);font-weight:500;background-color:var(--c-surface);white-space:nowrap}.rhythm-ui-button--boundary:hover,.rhythm-ui-button--boundary:focus-visible{background-color:var(--c-border);border-color:var(--c-border-strong)}.macrobeat-adjust-group{display:flex;gap:var(--space-025);justify-content:center}.time-signature-label{background:var(--c-surface-overlay);border-radius:12px;font-weight:700;font-size:var(--rhythm-ui-button-font-size);color:var(--c-text-muted);-webkit-user-select:none;user-select:none;position:absolute;transform:translate(-50%);top:var(--time-sig-vertical-offset, .25rem);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);border:2px solid var(--c-border);padding:.125rem .375rem;cursor:pointer}.time-signature-label.anacrusis-label{color:var(--c-border)}.time-signature-bracket{pointer-events:none;z-index:5}.bracket-label{font-weight:700;font-size:.85em;color:var(--c-text-muted);-webkit-user-select:none;user-select:none;pointer-events:none;white-space:nowrap}input[type=range]{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:100%;height:var(--space-025);border-radius:var(--border-radius-sm);background:var(--c-gridline);outline:none;margin-block-start:var(--space-025);margin-block-end:0}#tempo-slider{writing-mode:vertical-lr;direction:rtl;width:var(--slider-track-thickness);height:100%;max-height:100%;margin:0 auto;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:var(--c-gridline);border-radius:var(--border-radius-sm);outline:none}#tempo-slider::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:var(--slider-thumb-size);height:var(--slider-thumb-size);border-radius:50%;background:var(--c-text);border:var(--slider-thumb-border) solid var(--c-surface);cursor:pointer}#tempo-slider::-webkit-slider-thumb:active{background:var(--c-text);border:var(--slider-thumb-border) solid var(--c-surface)}#tempo-slider::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);border-radius:50%;background:var(--c-text);border:var(--slider-thumb-border) solid var(--c-surface);cursor:pointer}#tempo-slider::-moz-range-thumb:active{background:var(--c-text);border:var(--slider-thumb-border) solid var(--c-surface)}#tempo-slider::-moz-range-track{background:var(--c-gridline);border-radius:var(--border-radius-sm);border:none}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:18px;height:18px;border-radius:50%;background:var(--c-text);border:2px solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:pointer}input[type=range]::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:var(--c-text);border:2px solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:pointer}.slider-label{margin-block-start:var(--space-025);color:var(--c-text-muted);text-align:center;-webkit-user-select:none;user-select:none}.control-section:has(.tempo-container){width:auto;min-width:max-content}.tempo-content-box{height:100%;max-height:100%;display:flex;flex-direction:column;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-sm);padding:var(--space-015)}.tempo-container{display:grid;grid-template-columns:1fr auto;grid-template-rows:1fr;gap:var(--space-0);background-color:transparent;border:none;padding:0 var(--space-015);border-radius:0;height:100%;max-height:100%;flex:1;width:auto;min-width:max-content;align-items:stretch}.tempo-column{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;gap:var(--space-035);grid-column:1;grid-row:1;height:100%;max-height:100%}.tempo-column-2{display:flex;justify-content:center;align-items:center;grid-column:2;grid-row:1;min-width:var(--slider-thumb-total);width:var(--slider-thumb-total);height:100%;max-height:100%;padding:0rem}.tempo-input-group{display:flex;flex-direction:row;align-items:center;gap:var(--space-015)}.tempo-label-icon{height:1.2rem;width:auto;-webkit-user-select:none;user-select:none;transform-origin:center;transition:transform .08s ease-out}#eighth-note-tempo,#quarter-note-tempo,#dotted-quarter-tempo{transform-origin:center;transition:transform .08s ease-out}.tempo-input{width:45px;background-color:var(--c-bg);color:var(--c-text);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);text-align:center;font-family:var(--main-font)}.tempo-input::-webkit-outer-spin-button,.tempo-input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.draggable-number-input{cursor:ns-resize;transition:border-color .2s ease,box-shadow .2s ease}.draggable-number-input:hover{border-color:var(--c-accent)}.draggable-number-input:focus{cursor:text;box-shadow:0 0 0 2px var(--c-accent-light)}#note-bank-container{display:grid;grid-template-rows:repeat(4,minmax(0,1fr));gap:var(--space-030);align-content:stretch;justify-items:stretch;min-height:0;--note-size: 100%}.note-bank-column{display:contents}.note-pair{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:var(--space-020);align-items:center;justify-items:center;block-size:100%;padding:var(--space-010);border-radius:var(--border-radius-md);border:2px solid transparent;background-color:transparent}.note{inline-size:auto;max-inline-size:100%;block-size:100%;aspect-ratio:1 / 1;margin:0;cursor:pointer;border-radius:50%;transition:transform .2s;background-color:transparent;border:4px solid var(--note-color)}.note:hover{transform:scale(1.05)}.oval-note{aspect-ratio:.7 / 1;block-size:100%;inline-size:auto;max-inline-size:100%;justify-self:center}.note-pair[data-color="#4a90e2"] .note{--note-color: #4a90e2}.note-pair[data-color="#2d2d2d"] .note{--note-color: #2d2d2d}.note-pair[data-color="#d66573"] .note{--note-color: #d66573}.note-pair[data-color="#68a03f"] .note{--note-color: #68a03f}.eraser-icon{width:100%;height:100%;object-fit:contain}.tab-button{padding:var(--space-025) var(--space-035);background-color:var(--c-surface-muted);border:1px solid transparent;border-bottom-color:var(--c-border);color:var(--c-text-muted);font-family:var(--main-font);font-size:1.2em;font-weight:500;cursor:pointer;text-align:left;transition:all .2s ease;position:relative;border-top-left-radius:var(--border-radius-md);border-bottom-left-radius:var(--border-radius-md)}.tab-button:hover{background-color:var(--c-surface);color:var(--c-text)}.tab-button.active{background-color:var(--c-surface);color:var(--c-accent);font-weight:600;margin-right:-1px;position:relative;z-index:1;border-color:var(--c-border);border-right-color:transparent;border-top-right-radius:0;border-bottom-right-radius:0}.sidebar-button{background-color:transparent;border:none;border-radius:var(--border-radius-md);padding:var(--space-025) var(--space-035);margin-bottom:var(--space-025);display:flex;align-items:center;gap:var(--space-025);width:100%;text-align:left}.sidebar-button:hover{background-color:var(--c-surface-muted)}.sidebar-button img{width:20px;height:20px;flex-shrink:0;object-fit:contain}.sidebar-button-text{font-size:1rem;color:var(--c-text);font-weight:600;white-space:nowrap}.toolkit-button{line-height:1.2;padding:var(--space-025)}.toolkit-button--ghost{background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);transition:background-color .1s ease,border-color .1s ease,transform .1s ease}.toolkit-button--ghost:hover,.toolkit-button--ghost:focus-visible{background-color:var(--c-border);border-color:var(--c-border-strong);color:var(--c-text);outline:none}.toolkit-button--ghost:active{background-color:var(--c-warning);border-color:var(--c-warning);transform:scale(.95)}.toolkit-icon-button{font-size:var(--font-size-sm);inline-size:100%;block-size:100%;max-inline-size:100%;max-block-size:100%;aspect-ratio:1 / 1;display:inline-flex;align-items:center;justify-content:center;padding:0;background-color:transparent;border:1px solid transparent;color:var(--c-text-muted);border-radius:22%;transition:background-color .2s ease,transform .1s ease,border-color .2s ease;position:relative;flex:0 0 auto}.toolkit-icon-button img{width:100%;height:100%;object-fit:contain;pointer-events:none;transition:background-color .2s,transform .1s ease}.toolkit-icon-button:hover{background-color:var(--c-surface-muted);border-color:transparent}.toolkit-icon-button:focus{background-color:var(--c-surface-muted);border-color:transparent;outline:none}.toolkit-icon-button:active{transform:scale(.92);transition-duration:.05s;background-color:var(--c-warning);border-color:transparent}#undo-button,#redo-button{padding:var(--space-010);border-radius:calc(var(--border-radius-sm) - 1px)}#undo-button:hover,#redo-button:hover,#undo-button:focus,#redo-button:focus{background-color:#00000014}.playback-row{display:grid;grid-auto-flow:column;gap:var(--space-050)}.preset-effects-container{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;flex:1;width:100%;max-width:100%;min-width:fit-content;gap:0;box-sizing:border-box}.preset-effects-split{display:flex;flex-direction:row;gap:var(--space-2);width:100%;height:100%;align-items:stretch}.waveform-section{flex:0 0 auto;display:flex;flex-direction:column;align-items:stretch;justify-content:flex-start;min-height:0;max-height:100%;gap:0}.waveform-tab-button{cursor:default!important;pointer-events:none;border-bottom:none!important;border-bottom-left-radius:0!important;border-bottom-right-radius:0!important;width:100%;flex-shrink:0}.waveform-tab-button:disabled{opacity:1;background-color:var(--c-surface);color:var(--c-text);font-weight:600;border-color:var(--c-border)}.preset-effects-controls{flex:1;display:flex;flex-direction:column;min-width:0;min-height:0;max-height:100%;overflow:hidden}.preset-effects-tabs{display:flex;gap:0;margin-bottom:0}.preset-tab-button{padding:var(--space-1) var(--space-3);background-color:var(--c-surface-muted);border:1px solid var(--c-border);border-bottom:none;color:var(--c-text-muted);font-family:var(--main-font);font-size:.875rem;font-weight:500;cursor:pointer;text-align:center;transition:all .2s ease;position:relative;border-top-left-radius:var(--border-radius-md);border-top-right-radius:var(--border-radius-md);border-bottom-left-radius:0;border-bottom-right-radius:0}.preset-tab-button:not(:last-child){border-right:none}.preset-tab-button:hover{background-color:var(--c-surface);color:var(--c-text)}.preset-tab-button.active{background-color:var(--c-surface);color:var(--c-text);font-weight:600;border-color:var(--c-border);border-bottom-color:var(--c-surface);z-index:2;margin-bottom:-1px}.preset-effects-content{position:relative;width:100%;height:100%;margin:0;padding:0;display:flex;flex-direction:column;overflow:hidden;min-height:0}.preset-tab-panel{display:none}.preset-tab-panel.active{display:flex;flex-direction:column;height:100%;min-height:0;overflow:hidden}.preset-content-box,.effects-content-box{background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);padding:var(--space-2);box-shadow:var(--box-shadow-sm);position:relative;z-index:1;width:100%;max-width:100%;min-width:fit-content;overflow:visible;flex:1;box-sizing:border-box;display:flex;flex-direction:column;align-items:center;justify-content:center}.waveform-content-box{background-color:var(--c-surface);border:0px solid var(--c-border);border-radius:var(--border-radius-md);border-top-left-radius:0;border-top-right-radius:0;padding:var(--space-2);box-shadow:var(--box-shadow-sm);position:relative;z-index:1;width:100%;max-width:100%;min-width:fit-content;overflow:hidden;flex:1;box-sizing:border-box;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:0;max-height:100%;margin-top:-1px}.preset-tab-panel.active[id=presets-panel] .preset-content-box{border-top-left-radius:0}.preset-tab-panel.active[id=reverb-delay-panel] .effects-content-box{border-top-left-radius:var(--border-radius-md);border-top-right-radius:var(--border-radius-md)}.preset-tab-panel.active[id=vibrato-tremolo-panel] .effects-content-box{border-top-right-radius:0}.effects-content-box{height:fit-content}.preset-tab-panel.active[id=presets-panel] .preset-content-box:before{content:"";position:absolute;top:-1px;left:calc(50% - 35px);width:70px;height:1px;background-color:var(--c-surface);z-index:3}.preset-tab-panel.active[id=reverb-delay-panel] .effects-content-box:before{content:"";position:absolute;top:-1px;left:calc(50% - 47px);width:94px;height:1px;background-color:var(--c-surface);z-index:3}.preset-tab-panel.active[id=vibrato-tremolo-panel] .effects-content-box:before{content:"";position:absolute;top:-1px;left:calc(50% - 52px);width:104px;height:1px;background-color:var(--c-surface);z-index:3}.preset-grid{display:flex;gap:var(--space-2);width:100%;height:100%;justify-content:center;align-items:stretch}.preset-column{display:flex;flex-direction:column;gap:var(--space-1);flex:1;height:100%;align-items:stretch;justify-content:space-evenly;container-type:inline-size}.preset-button{width:100%;min-width:fit-content;justify-content:center;display:flex;align-items:center;padding:.1rem .5rem;background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);font-size:.75rem;white-space:nowrap;box-sizing:border-box;container-type:inline-size}.preset-button:hover{background-color:var(--c-border)}.preset-effects-container .preset-button.selected{background-color:var(--c-accent-light, #63a9fd)!important;color:var(--c-text, #212529)!important;border-color:var(--c-accent, #4A90E2)!important;font-weight:600!important;box-shadow:0 0 0 1px var(--c-accent, #4A90E2)!important;transform:scale(.98)!important;opacity:1!important}.effects-grid{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(2,1fr);row-gap:.15rem;column-gap:.15rem;margin-bottom:0}.effect-button{width:4.5rem;justify-content:center;display:flex;align-items:center;padding:.1rem;background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:background-color .2s ease}.effect-button:hover{background-color:var(--c-border)}.effect-button.active{background-color:var(--c-accent-light, #63a9fd);color:var(--c-text, #212529);border-color:var(--c-accent, #4A90E2);font-weight:600;box-shadow:0 0 0 2px var(--c-accent, rgba(74, 144, 226, .2));transform:scale(.98)}.effect-controls-container{padding-top:.15rem;margin-top:0rem;min-height:2rem;display:none}.effect-controls-container.active{display:block;min-height:auto;height:fit-content}.effect-controls{display:grid;grid-template-columns:repeat(auto-fit,minmax(80px,1fr));gap:var(--space-3);align-items:start;justify-items:center;padding:var(--space-2) 0}.effect-control-group{display:flex;flex-direction:column;gap:var(--space-1);align-items:center;min-width:80px;position:relative}.effect-control-label{font-size:.5rem;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.5px;font-weight:500}.effect-control-slider{width:100%;height:4px;background:var(--c-border);border-radius:2px;outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none}.effect-control-slider::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;background:var(--c-accent);cursor:pointer;border:2px solid var(--c-surface);box-shadow:0 2px 4px #0003}.effect-control-slider::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:var(--c-accent);cursor:pointer;border:2px solid var(--c-surface);box-shadow:0 2px 4px #0003}.effect-control-value{font-size:.75rem;color:var(--c-text);font-weight:600;min-width:30px;text-align:center}#accidental-controls-container-v2{display:flex;justify-content:center;gap:var(--space-025)}.accidental-button{width:30px;height:30px;font-size:18px;font-weight:700;padding:0;line-height:1;border:1px solid var(--c-border);border-radius:var(--border-radius-sm);background-color:transparent;color:var(--c-text);opacity:.6}.accidental-button.active{background-color:var(--c-warning);color:var(--c-text);opacity:1}.accidental-button:not(.active):hover{background-color:var(--c-border)}.pitch-tabs-container{display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;flex:1 1 auto;width:100%;min-width:0;gap:0;height:100%}.pitch-tabs{display:flex;gap:0;margin-bottom:calc(-1 * var(--space-005));position:relative;z-index:1}.pitch-tab-button{padding:var(--space-015) var(--space-035);background-color:var(--c-surface-muted);border:1px solid var(--c-border);border-bottom:none;color:var(--c-text-muted);font-family:var(--main-font);font-size:.875rem;font-weight:500;cursor:pointer;text-align:center;transition:all .2s ease;position:relative;border-top-left-radius:var(--border-radius-md);border-top-right-radius:var(--border-radius-md);border-bottom-left-radius:0;border-bottom-right-radius:0}.pitch-tab-button+.pitch-tab-button{margin-left:-1px}.pitch-tab-button:hover{background-color:var(--c-border);color:var(--c-text)}.pitch-tab-button.active{background-color:var(--c-surface);color:var(--c-text);font-weight:600;border-color:var(--c-border);border-bottom-color:transparent;z-index:2;margin-bottom:-1px}.pitch-tab-content{position:relative;width:100%}.pitch-tab-panel{display:none}.pitch-tab-panel.active{display:block}.intervals-content-box,.chords-content-box,.tonic-content-box{background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);padding:var(--space-015);box-shadow:var(--box-shadow-sm);position:relative;z-index:1;width:100%;height:100%}.pitch-tab-panel.active .intervals-content-box:before{content:"";position:absolute;top:-1px;left:calc(50% - 50px);width:60px;height:1px;background-color:transparent;z-index:3}.pitch-tab-panel.active .chords-content-box:before{content:"";position:absolute;top:-1px;left:calc(50% + 10px);width:50px;height:1px;background-color:transparent;z-index:3}.harmony-preset-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:var(--space-015);flex:1}.harmony-preset-grid.chords-grid-6col{grid-template-columns:repeat(6,1fr);grid-auto-rows:1fr;gap:var(--space-015)}.harmony-preset-button{background-color:transparent;color:var(--c-text);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);font-size:18px;font-weight:700;min-height:40px}.chords-grid-6col .harmony-preset-button{font-size:14px;min-height:32px;padding:2px 4px}.intervals-layout{display:flex;gap:var(--space-025);align-items:flex-start}.inversion-column{display:flex;flex-direction:column;align-items:flex-start;gap:var(--space-025);flex:0 0 auto}.inversion-column h4{margin:0;color:var(--c-text-muted);font-size:.8em;text-transform:uppercase;letter-spacing:.5px;text-align:center}.toggle-switch{width:20px;height:40px;background-color:var(--c-border);border-radius:10px;position:relative;cursor:pointer;transition:background-color .3s ease}.toggle-switch.active{background-color:var(--c-border)}.toggle-slider{width:16px;height:16px;background-color:transparent;border-radius:50%;position:absolute;top:2px;left:2px;transition:transform .3s ease;box-shadow:0 1px 3px #0003}.toggle-switch.active .toggle-slider{transform:translateY(20px)}.chords-layout{display:flex;gap:var(--space-015);align-items:flex-start}.chord-inversion-column{display:flex;flex-direction:column;align-items:flex-start;gap:var(--space-015);flex:0 0 auto;text-align:left}.chord-inversion-column h4{margin:0;color:var(--c-text-muted);font-size:.7em;text-transform:uppercase;letter-spacing:.5px;text-align:left!important}.three-state-toggle{width:20px;height:60px;background-color:var(--c-border);border-radius:10px;position:relative;cursor:pointer;transition:background-color .3s ease}.three-state-toggle.state-1,.three-state-toggle.state-2{background-color:var(--c-border)}.three-state-slider{width:16px;height:16px;background-color:transparent;border-radius:50%;position:absolute;top:2px;left:2px;transition:transform .3s ease;box-shadow:0 1px 3px #0003}.three-state-toggle.state-1 .three-state-slider{transform:translateY(20px)}.three-state-toggle.state-2 .three-state-slider{transform:translateY(40px)}.state-labels{display:flex;flex-direction:column;justify-content:space-between;height:60px;margin-left:var(--space-035);position:absolute;left:100%;top:0;font-size:.6em;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.3px}.state-label{flex:1;display:flex;align-items:center;justify-content:flex-start;height:20px}.four-state-toggle{width:20px;height:80px;background-color:var(--c-border);border-radius:10px;position:relative;cursor:pointer;transition:background-color .3s ease}.four-state-toggle.state-1,.four-state-toggle.state-2,.four-state-toggle.state-3{background-color:var(--c-border)}.four-state-slider{width:16px;height:16px;background-color:transparent;border-radius:50%;position:absolute;top:2px;left:2px;transition:transform .3s ease;box-shadow:0 1px 3px #0003}.four-state-toggle.state-1 .four-state-slider{transform:translateY(20px)}.four-state-toggle.state-2 .four-state-slider{transform:translateY(40px)}.four-state-toggle.state-3 .four-state-slider{transform:translateY(60px)}.state-labels-4{display:flex;flex-direction:column;justify-content:space-between;height:80px;margin-left:var(--space-035);position:absolute;left:100%;top:0;font-size:.6em;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.3px}.state-labels-4 .state-label{flex:1;display:flex;align-items:center;justify-content:flex-start;height:20px}.five-state-toggle{width:20px;height:100px;background-color:var(--c-border);border-radius:10px;position:relative;cursor:pointer;transition:background-color .3s ease}.five-state-toggle.state-1,.five-state-toggle.state-2,.five-state-toggle.state-3,.five-state-toggle.state-4{background-color:var(--c-border)}.five-state-slider{width:16px;height:16px;background-color:transparent;border-radius:50%;position:absolute;top:2px;left:2px;transition:transform .3s ease;box-shadow:0 1px 3px #0003}.five-state-toggle.state-1 .five-state-slider{transform:translateY(20px)}.five-state-toggle.state-2 .five-state-slider{transform:translateY(40px)}.five-state-toggle.state-3 .five-state-slider{transform:translateY(60px)}.five-state-toggle.state-4 .five-state-slider{transform:translateY(80px)}.state-labels-5{display:flex;flex-direction:column;justify-content:space-between;height:100px;margin-left:var(--space-035);position:absolute;left:100%;top:0;font-size:.6em;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.3px}.state-labels-5 .state-label{flex:1;display:flex;align-items:center;justify-content:flex-start;height:20px}.six-state-toggle{width:20px;height:120px;background-color:var(--c-border);border-radius:10px;position:relative;cursor:pointer;transition:background-color .3s ease}.six-state-toggle.state-1,.six-state-toggle.state-2,.six-state-toggle.state-3,.six-state-toggle.state-4,.six-state-toggle.state-5{background-color:var(--c-border)}.six-state-slider{width:16px;height:16px;background-color:transparent;border-radius:50%;position:absolute;top:2px;left:2px;transition:transform .3s ease;box-shadow:0 1px 3px #0003}.six-state-toggle.state-1 .six-state-slider{transform:translateY(20px)}.six-state-toggle.state-2 .six-state-slider{transform:translateY(40px)}.six-state-toggle.state-3 .six-state-slider{transform:translateY(60px)}.six-state-toggle.state-4 .six-state-slider{transform:translateY(80px)}.six-state-toggle.state-5 .six-state-slider{transform:translateY(100px)}.state-labels-6{display:flex;flex-direction:column;justify-content:space-between;height:120px;margin-left:var(--space-035);position:absolute;left:100%;top:0;font-size:.6em;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.3px}.state-labels-6 .state-label{flex:1;display:flex;align-items:center;justify-content:flex-start;height:20px}.six-state-toggle.disabled-state-3 .state-labels-6 .state-label:nth-child(4),.six-state-toggle.disabled-state-4 .state-labels-6 .state-label:nth-child(5),.six-state-toggle.disabled-state-5 .state-labels-6 .state-label:nth-child(6){opacity:.3;pointer-events:none}.hidden{display:none}.intervals-grid-column,.chords-grid-column{flex:1}.intervals-4x4-grid{gap:2px}.intervals-4x4-grid .harmony-preset-button{width:40px;height:30px;min-height:20px;display:flex;align-items:center;justify-content:center;padding:0}.harmony-preset-button:hover{background-color:var(--c-border)}.harmony-preset-button:focus{background-color:transparent;color:var(--c-text);outline:none}.harmony-preset-button:focus:hover{background-color:var(--c-border)}.harmony-preset-button.selected:focus{background-color:var(--c-accent);color:var(--c-surface)}.harmony-preset-button.selected{background-color:var(--c-accent-light, #63a9fd);color:var(--c-text, #212529);border-color:var(--c-accent, #4A90E2);font-weight:600}.dropdown-container{position:relative;display:inline-block}.dropdown-container.open{z-index:1000}.tonic-dropdown-toggle,.degree-dropdown-toggle{display:flex;align-items:center;gap:var(--space-025);justify-content:center;background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border)}.tonic-dropdown-toggle{padding:var(--space-015) var(--space-025)}.dropdown-arrow{font-size:10px;transition:transform .2s ease}.dropdown-container.open .dropdown-arrow{transform:rotate(180deg)}.dropdown-menu{display:none;position:absolute;top:100%;left:50%;transform:translate(-50%);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-md);z-index:1001;padding:var(--space-015);flex-direction:column;gap:0rem;margin-top:0rem;overflow-y:auto;white-space:nowrap;width:max-content}.dropdown-container.open .dropdown-menu{display:flex}.tonic-sign-button{background:transparent;border:none;padding:var(--space-015);display:flex;align-items:center;gap:var(--space-025);white-space:nowrap}.tonic-sign-button:hover{background-color:var(--c-surface-muted)}.mode-label{font-size:var(--font-size-sm);color:var(--c-text-muted);font-weight:400}.tonic-shape-icon{width:1.5rem;height:1.5rem;object-fit:contain;display:block}.dropdown-menu .tonic-shape-icon{width:32px;height:32px}.tonic-dropdown-toggle.selected,#degree-dropdown-menu .toolkit-button.active{border-color:var(--c-accent);box-shadow:0 0 5px var(--c-accent)}.dropdown-menu .tonic-sign-button:hover,.dropdown-menu .tonic-sign-button.selected:hover,#degree-dropdown-menu .toolkit-button:hover{background-color:var(--c-surface-muted)!important;color:var(--c-text)!important}#degree-dropdown-menu .toolkit-button:not(.active):hover{background-color:var(--c-surface-muted)!important;color:var(--c-text)!important}.tonic-dropdown-toggle:hover,.degree-dropdown-toggle:hover{background-color:var(--c-surface-muted)!important;color:var(--c-text)!important}.time-signature-label{cursor:pointer;padding:2px 6px;border-radius:var(--border-radius-sm);transition:background-color .2s ease}.time-signature-label:hover{background-color:var(--c-gridline)}.time-signature-dropdown{position:fixed;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-md);z-index:1000;max-width:300px;max-height:400px;overflow-y:auto;padding:var(--space-025)}.time-signature-dropdown.hidden{display:none}.dropdown-category{margin-bottom:var(--space-035)}.dropdown-category:last-child{margin-bottom:0}.dropdown-category-header{font-size:var(--font-size-sm);font-weight:600;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.5px;margin-bottom:var(--space-025);padding-bottom:var(--space-015);border-bottom:1px solid var(--c-gridline)}.dropdown-option{display:flex;flex-direction:column;padding:var(--space-025);cursor:pointer;border-radius:var(--border-radius-sm);transition:background-color .2s ease;margin-bottom:var(--space-015)}.dropdown-option:hover{background-color:var(--c-gridline)}.dropdown-option:last-child{margin-bottom:0}.dropdown-label{font-weight:600;font-size:var(--font-size-base);color:var(--c-text)}.dropdown-description{font-size:var(--font-size-sm);color:var(--c-text-muted);margin-top:2px}.dial-container{display:flex;flex-direction:column;align-items:center;gap:var(--space-015);-webkit-user-select:none;user-select:none}.dial-svg{cursor:pointer;transition:transform .1s ease}.dial-svg:hover{transform:scale(1.05)}.dial-svg.dragging{cursor:grabbing;transform:scale(1.1)}.dial-background{fill:var(--c-surface);stroke:var(--c-border);stroke-width:2}.dial-track{stroke:var(--c-border);stroke-width:4;stroke-linecap:round;opacity:.3}.dial-handle{stroke:var(--c-accent);stroke-width:4;stroke-linecap:round;filter:drop-shadow(0 0 3px var(--c-accent))}.dial-handle-line{stroke:var(--c-accent);stroke-width:3;stroke-linecap:round;filter:drop-shadow(0 0 2px var(--c-accent))}.dial-indicator{fill:var(--c-accent);stroke:var(--c-surface);stroke-width:2;filter:drop-shadow(0 0 3px var(--c-accent))}.dial-screw{fill:var(--c-text-muted);stroke:var(--c-border);stroke-width:1}.dial-label{font-size:.8rem;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.5px;font-weight:500;text-align:center;margin-bottom:var(--space-015)}.dial-value{font-size:.75rem;color:var(--c-text);font-weight:600;min-width:30px;text-align:center;background-color:var(--c-gridline);padding:2px 6px;border-radius:var(--border-radius-sm);border:1px solid var(--c-border)}.dial-svg:hover .dial-background{fill:var(--c-gridline)}.dial-svg:hover .dial-handle{stroke-width:5}.dial-svg:hover .dial-handle-line{stroke-width:4}.dial-svg:hover .dial-indicator{r:5;filter:drop-shadow(0 0 4px var(--c-accent))}.dial-svg.dragging .dial-background{fill:var(--c-gridline);stroke:var(--c-accent)}.dial-svg.dragging .dial-handle{stroke-width:5;filter:drop-shadow(0 0 6px var(--c-accent))}.dial-svg.dragging .dial-indicator{r:5;filter:drop-shadow(0 0 6px var(--c-accent));stroke-width:3}.dial-svg.dragging .dial-value{background-color:var(--c-accent);color:var(--c-surface);border-color:var(--c-accent-hover)}.effect-control-group .nexus-dial-label{font-size:.8rem;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.5px;font-weight:500;text-align:center;margin-bottom:var(--space-015)}.effect-control-group .nexus-dial-value{font-size:.75rem;color:var(--c-text);font-weight:600;min-width:30px;text-align:center;background-color:var(--c-surface);padding:.5rem;border-radius:var(--border-radius-sm);border:1px solid var(--c-border);box-shadow:0 4px 12px #0003;position:absolute;z-index:1000;top:-40px;left:50%;transform:translate(-50%);opacity:0;pointer-events:none;transition:opacity .2s ease,transform .2s ease;display:none}.effect-control-group svg{filter:drop-shadow(0 2px 4px rgba(0,0,0,.1))}.effect-control-group svg circle:first-child{fill:var(--c-surface)!important;stroke:var(--c-border)!important;stroke-width:2!important}.effect-control-group svg circle:last-child{fill:var(--c-text-muted)!important}.effect-control-group svg path{stroke:var(--c-accent)!important;fill:var(--c-accent)!important}.effect-control-group:hover svg{transform:scale(1.05);transition:transform .2s ease}.effect-control-group:hover svg circle:first-child{fill:var(--c-gridline)!important}.effect-control-group:hover .nexus-dial-value{display:block;opacity:1;transform:translate(-50%) translateY(-5px);background-color:var(--c-accent);color:var(--c-surface);border-color:var(--c-accent-hover)}#dial-container{display:flex;justify-content:center;align-items:flex-start;flex-direction:row;row-gap:0rem;column-gap:var(--space-035);padding-right:.4rem;padding-left:.1rem;padding-bottom:0rem;overflow:visible;background-color:var(--c-gridline);border:1px solid var(--c-border);border-radius:10px;margin:0 auto;width:fit-parent;height:fit-content}#dial-container svg{overflow:visible}.dial-wrapper{display:flex;flex-direction:column;align-items:center;gap:0rem;position:relative;margin:0rem}.dial-value{font-size:.75rem;color:var(--c-text);font-weight:600;min-width:30px;text-align:center;background-color:var(--c-surface);padding:2px 6px;border-radius:var(--border-radius-sm);border:1px solid var(--c-border);box-shadow:0 4px 12px #0003;position:absolute;z-index:1000;bottom:-40px;left:50%;transform:translate(-50%);transition:opacity .2s ease,transform .2s ease;display:none}.dial-value-hidden{display:none}.dial-value-visible{display:block;opacity:1;transform:translate(-50%) translateY(5px);background-color:var(--c-accent);color:var(--c-surface);border-color:var(--c-accent-hover);box-shadow:0 4px 12px #0003}.rhythm-tab-button{padding:var(--space-1) var(--space-3);background-color:var(--c-surface-muted);border:1px solid var(--c-border);border-bottom:none;color:var(--c-text-muted);font-family:var(--main-font);font-size:.875rem;font-weight:500;cursor:pointer;text-align:center;transition:all .2s ease;position:relative;border-top-left-radius:var(--border-radius-md);border-top-right-radius:var(--border-radius-md)}.rhythm-tab-button+.rhythm-tab-button{margin-left:-1px}.rhythm-tab-button:hover{background-color:var(--c-surface);color:var(--c-text)}.rhythm-tab-button.active{background-color:var(--c-surface);color:var(--c-text);font-weight:600;border-color:var(--c-border);border-bottom-color:var(--c-surface);z-index:1;margin-bottom:-1px}.stamp-button{position:relative;width:fit-content;height:fit-content;min-width:0rem;min-height:0rem;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);cursor:pointer;transition:all .2s ease;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:0rem}.stamp-button:hover{background-color:var(--c-gridline);transform:scale(1.05);border-color:var(--c-accent)}.stamp-button.active{background-color:var(--c-accent-light, #63a9fd)!important;color:var(--c-text, #212529)!important;border-color:var(--c-accent, #4A90E2)!important;font-weight:600!important;box-shadow:0 0 0 1px var(--c-accent, #4A90E2)!important;transform:scale(.98)!important;opacity:1!important}.stamp-button svg{flex-shrink:0}.stamp-number{font-size:.7rem;font-weight:600;color:var(--c-text-muted);line-height:1}.stamp-button.active .stamp-number{color:var(--c-text)}.triplet-button{position:relative;width:fit-content;height:fit-content;min-width:0rem;min-height:0rem;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);cursor:pointer;transition:all .2s ease;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:0rem}.triplet-button:hover{background-color:var(--c-gridline);transform:scale(1.05);border-color:var(--c-accent)}.triplet-button.active{background-color:var(--c-accent-light, #63a9fd)!important;color:var(--c-text, #212529)!important;border-color:var(--c-accent, #4A90E2)!important;font-weight:600!important;box-shadow:0 0 0 1px var(--c-accent, #4A90E2)!important;transform:scale(.98)!important;opacity:1!important}.triplet-button svg{flex-shrink:0}.triplet-button-wide{min-width:96px;position:relative}.triplet-button-wide:after{content:"";position:absolute;top:10%;bottom:10%;left:50%;width:1px;border-left:1px dashed var(--c-border);pointer-events:none;z-index:1}.triplets-header{font-size:1.1rem;font-weight:600;color:var(--c-text);margin:0;text-align:center}.sidebar-toggle-button{flex:1;padding:var(--space-2);text-align:center;background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);opacity:.6}.sidebar-toggle-button.active{background-color:var(--c-warning);color:var(--c-text);border-color:var(--c-border);opacity:1}.sidebar-toggle-button:not(.active):hover{background-color:var(--c-border)}.macrobeat-adjust-group .toolkit-button{background-color:var(--c-surface);border:1px solid var(--c-border);color:var(--c-text);transition:background-color .1s ease,transform .1s ease}.macrobeat-adjust-group .toolkit-button:hover{background-color:var(--c-border)}.macrobeat-adjust-group .toolkit-button:active{background-color:var(--c-warning);transform:scale(.95);transition:background-color .1s ease,transform .1s ease}.modulation-controls .toolkit-button{font-size:12px;padding:var(--space-1) var(--space-2);background-color:var(--c-surface-muted);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);color:var(--c-text);transition:all .2s ease;cursor:pointer;min-width:50px}.modulation-controls .toolkit-button:hover{background-color:var(--c-accent-light);border-color:var(--c-accent);color:var(--c-accent)}.modulation-controls .toolkit-button.active{background-color:var(--c-accent);border-color:var(--c-accent);color:#fff;font-weight:600}.modulation-ratio-btn[data-ratio="2:3"].active{background-color:#dc3545;border-color:#dc3545}.modulation-ratio-btn[data-ratio="3:2"].active{background-color:#007bff;border-color:#007bff}.modulation-ratio-btn[data-ratio="2:3"]:hover{background-color:#dc35451a;border-color:#dc3545;color:#dc3545}.modulation-ratio-btn[data-ratio="3:2"]:hover{background-color:#007bff1a;border-color:#007bff;color:#007bff}.position-controls-container{display:flex;padding-top:.6rem;justify-content:center;align-items:flex-start;background-color:var(--c-surface);gap:.5rem;padding-left:0rem;padding-right:0rem}.position-control-group{display:flex;flex-direction:column;align-items:center;gap:0rem;min-width:100px;position:relative;margin-left:0rem;z-index:10}.position-label{font-size:.8rem;font-weight:600;color:var(--c-text);margin:0rem;text-align:center;text-transform:uppercase;letter-spacing:.5px;position:absolute;top:.3rem;left:50%;transform:translate(-50%);z-index:10}.position-component{width:5.5rem;height:5.5rem;overflow:hidden;position:relative;z-index:15}.position-component svg{display:block;position:relative;z-index:20}.position-axis-labels{display:flex;justify-content:space-between;align-items:center;width:100%;position:relative;font-size:.6rem;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.5px;font-weight:500}.x-label{position:absolute;bottom:.1rem;left:50%;transform:translate(-50%)}.y-label{position:absolute;left:.9rem;top:-2.5rem;transform:rotate(-90deg);transform-origin:left center}@media (max-width: 768px){.position-controls-container{flex-direction:column;gap:var(--space-035)}.position-control-group{min-width:auto;width:100%}.position-component{width:100px;height:100px}}:root{--position-bg-blue: rgba(74, 144, 226, .1);--position-handle-blue: #4a90e2;--position-bg-black: rgba(45, 45, 45, .1);--position-handle-black: #2d2d2d;--position-bg-red: rgba(214, 101, 115, .1);--position-handle-red: #d66573;--position-bg-green: rgba(104, 160, 63, .1);--position-handle-green: #68a03f}#harmony-toolkit-container{display:flex;align-items:center;justify-content:center;padding:0 var(--space-025)}#x-chord-shape-tool{width:40px;height:40px;font-size:20px;font-weight:700;padding:0;border:1px solid var(--c-border);background-color:var(--c-surface);color:var(--c-text);border-radius:var(--border-radius-sm)}#x-chord-shape-tool.selected{border:2px solid var(--c-accent);box-shadow:0 0 5px var(--c-accent)}#chord-toolbar-wrapper{background-color:var(--c-gridline);border:1px solid var(--c-border);border-radius:var(--border-radius-md);display:flex;align-items:center;padding:var(--space-015);margin-top:var(--space-025);width:100%;box-shadow:none;transition:opacity .2s}#chord-toolbar-wrapper.collapsed{display:none}.chord-toolbar-panel{display:flex;gap:var(--space-015)}.chord-toolbar-panel select{padding:var(--space-015);border-radius:var(--border-radius-sm);border:1px solid var(--c-border);background-color:var(--c-bg);transition:border-color .2s}.chord-toolbar-panel select option:disabled{color:var(--c-text-muted);opacity:.5;pointer-events:none}.chord-toolbar-panel select.invalid-reset{border-color:var(--c-danger);box-shadow:0 0 3px var(--c-danger)}#chord-toolbar-collapse-btn{background:none;border:none;color:var(--c-text-muted);font-size:16px;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:var(--border-radius-sm)}#chord-toolbar-collapse-btn:hover{background-color:var(--c-gridline)}#tonic-mode-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(110px,1fr));gap:var(--space-015);width:100%;align-items:stretch;justify-items:stretch;flex:1 1 320px}#tonic-mode-grid .tonic-sign-button{border:1px solid var(--c-border);border-radius:var(--border-radius-sm);background-color:var(--c-surface);padding:var(--space-015) var(--space-025);display:flex;flex-direction:row;align-items:center;justify-content:center;gap:var(--space-015);transition:background-color .2s ease,border-color .2s ease,color .2s ease,box-shadow .2s ease;width:100%;color:var(--c-text)}#tonic-mode-grid .tonic-sign-button .mode-label{font-size:.8rem;color:var(--c-text);font-weight:600}#tonic-mode-grid .tonic-sign-button .tonic-shape-icon{width:1.4rem;height:1.4rem}#tonic-mode-grid .tonic-sign-button:hover{background-color:var(--c-surface-muted);border-color:var(--c-border-strong)}#tonic-mode-grid .tonic-sign-button.selected{background:var(--c-accent);border-color:var(--c-accent);color:var(--c-surface);box-shadow:0 0 8px #4a90e273}#tonic-mode-grid .tonic-sign-button.selected .mode-label{color:var(--c-surface)}#tonic-mode-grid .tonic-sign-button:focus-visible{outline:2px solid var(--c-accent);outline-offset:2px}.tonic-tools-wrapper{display:flex;flex-direction:row;flex-wrap:wrap;gap:var(--space-015);align-items:stretch;width:100%}.degree-toggle-container{display:flex;flex-direction:column;gap:var(--space-025);align-items:stretch;justify-content:center;flex:0 1 220px}.degree-visibility-toggle-container{display:flex;flex-direction:column;align-items:center;gap:var(--space-015);justify-content:center}.degree-visibility-toggle-container .toggle-text{font-size:.8em;font-weight:500;color:var(--c-text)}.degree-mode-toggle-container{display:flex;justify-content:center}.degree-toggle-container .two-state-toggle{position:relative;width:120px;height:30px;background-color:var(--c-gridline);border:2px solid var(--c-border);border-radius:15px;cursor:pointer;-webkit-user-select:none;user-select:none;transition:all .3s ease}.degree-toggle-container .two-state-toggle.disabled{opacity:.5;background-color:var(--c-border)}.degree-toggle-container .two-state-slider{position:absolute;top:2px;left:2px;width:56px;height:26px;background-color:var(--c-accent);border-radius:13px;transition:transform .3s ease;box-shadow:0 2px 4px #0003}.degree-toggle-container .two-state-toggle.active .two-state-slider{transform:translate(60px)}.degree-toggle-container .toggle-labels{display:flex;justify-content:space-between;align-items:center;height:100%;padding:0 var(--space-025);pointer-events:none}.degree-toggle-container .toggle-label{font-size:.7em;font-weight:600;color:var(--c-text-muted);transition:color .3s ease;z-index:1}.degree-toggle-container .two-state-toggle:not(.active) .toggle-label:first-child,.degree-toggle-container .two-state-toggle.active .toggle-label:last-child{color:var(--c-surface)}.degree-toggle-container .two-state-toggle.disabled .toggle-label{color:var(--c-text-muted);opacity:.7}.focus-colours-container .checkbox-text{font-size:.7em}.focus-colours-container{display:flex;align-items:center;justify-content:center;flex:0 1 140px}@media (max-width: 900px){.tonic-tools-wrapper{flex-direction:column}#tonic-mode-grid,.degree-toggle-container,.focus-colours-container{flex:1 1 auto}}.degree-toggle-container{display:flex;flex-direction:column;gap:var(--space-015)}.degree-visibility-toggle{width:100%;display:flex;justify-content:center;align-items:center;padding:var(--space-025);background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);opacity:.6;transition:background-color .2s,color .2s,opacity .2s}.degree-visibility-toggle.active{background-color:var(--c-surface);color:var(--c-text);opacity:1}.degree-visibility-toggle:not(.active):hover{background-color:var(--c-border)}.degree-mode-toggle{width:100%;display:flex;justify-content:center;align-items:center;padding:var(--space-025);background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);opacity:.6;transition:background-color .2s,color .2s,opacity .2s}.degree-mode-toggle.active{background-color:var(--c-warning);color:var(--c-text);opacity:1}.degree-mode-toggle:not(.active):hover{background-color:var(--c-border)}.clef-content-box{display:flex;flex-direction:column;gap:12px;padding:.2rem;background:var(--panel-surface, #f8f9fa);border-radius:16px;box-shadow:inset 0 1px #fff9}.clef-picker-grid{display:grid;grid-template-columns:repeat(2,auto) minmax(200px,240px);gap:12px;align-items:start;justify-content:start}.clef-picker-column{display:flex;flex-direction:column;gap:8px;align-items:flex-start;width:fit-content}.clef-wheel{position:relative;border-radius:18px;background:linear-gradient(180deg,#ffffffe6,#f8f9fad9);border:1px solid rgba(0,0,0,.05);box-shadow:0 10px 30px #00000014,inset 0 1px #ffffff80;height:150px;outline:none;cursor:grab;display:flex;align-items:center;justify-content:center;transition:box-shadow .2s ease,border-color .2s ease}.clef-wheel:focus-visible{border-color:var(--accent, #4a90e2);box-shadow:0 0 0 3px #4a90e240,inset 0 1px #fff9}.clef-wheel:active{cursor:grabbing}.clef-wheel-viewport{position:relative;width:100%;height:100%;overflow:hidden;display:flex;align-items:stretch;justify-content:center}.clef-wheel-options{position:relative;display:flex;flex-direction:column;align-items:center;width:100%;transform:translateY(0);transition:transform .18s ease-out;will-change:transform}.clef-wheel-option{width:100%;text-align:center;height:40px;display:flex;align-items:center;justify-content:center;font-size:.8rem;font-weight:500;color:#21252959;-webkit-user-select:none;user-select:none;pointer-events:none;transform-origin:center;transition:color .18s ease-out,transform .18s ease-out,opacity .18s ease-out;opacity:.3}.clef-wheel-option[data-distance="0"]{font-size:.95rem;color:var(--text-strong, #212529);opacity:1}.clef-wheel-option[data-distance="1"]{opacity:.55;transform:scale(.95)}.clef-wheel-option[data-distance="2"]{opacity:.4;transform:scale(.9)}.clef-wheel-overlay{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;background:linear-gradient(180deg,#f8f9faeb,#fff0 20%,#fff0 80%,#f8f9faeb);border-radius:18px}.clef-wheel-overlay:before{content:"";position:absolute;left:0%;right:0%;top:50%;height:30px;border-radius:16px;border:1px solid rgba(74,144,226,.35);background:#4a90e214;transform:translateY(-50%);box-shadow:inset 0 0 0 1px #fff6}.clef-summary-column{display:flex;flex-direction:column;height:100%;max-height:100%}.clef-summary-card{background:linear-gradient(180deg,#fffffff2,#f8f9faf2);border-radius:16px;padding:10px;border:1px solid rgba(0,0,0,.05);box-shadow:0 12px 24px #00000014;display:flex;flex-direction:column;gap:6px;height:100%;max-height:100%;overflow:auto;font-size:.65rem}.clef-summary-card h4{margin:0;font-size:.7rem;font-weight:600}.clef-summary-label{font-size:.8rem;font-weight:600;color:var(--text-strong, #212529);min-height:1.2em;line-height:1.2}.clef-summary-metadata{font-size:.65rem;color:var(--text-muted, #6c757d)}.clef-snap-toggle{display:flex;align-items:center;gap:6px;font-size:.65rem;color:var(--text-muted, #6c757d);margin-top:4px;-webkit-user-select:none;user-select:none;cursor:pointer}.clef-snap-toggle input[type=checkbox]{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:32px;height:16px;border-radius:16px;background:#00000026;position:relative;transition:background .2s ease;outline:none;cursor:pointer}.clef-snap-toggle input[type=checkbox]:after{content:"";position:absolute;top:2px;left:2px;width:12px;height:12px;border-radius:50%;background:#fff;box-shadow:0 1px 2px #00000040;transition:transform .2s ease}.clef-snap-toggle input[type=checkbox]:checked{background:rgba(var(--c-accent-rgb, 74, 144, 226),.7)}.clef-snap-toggle input[type=checkbox]:checked:after{transform:translate(16px)}.clef-preset-buttons{display:flex;gap:6px;margin-top:4px;flex-wrap:wrap}.clef-preset-button{flex:1;min-width:60px;padding:6px 10px;font-size:.65rem}.clef-wheel[data-disabled=true]{opacity:.5;cursor:not-allowed}@media (max-width: 1200px){.clef-picker-grid{grid-template-columns:repeat(2,auto);grid-auto-rows:auto}.clef-summary-column{grid-column:span 2}}@media (max-width: 900px){.clef-picker-grid{grid-template-columns:auto}.clef-summary-column{grid-column:span 1}}#pitch-paint-container{display:flex;flex-direction:column;gap:0rem;flex:1;width:fit-content}.paint-content-box{background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);padding:var(--space-015);box-shadow:var(--box-shadow-sm);position:relative;z-index:1;width:fit-content;height:fit-content;max-height:100%}.chord-tab-panel.active .paint-content-box:before{content:"";position:absolute;top:-1px;left:calc(50% + 20px);width:60px;height:1px;background-color:var(--c-surface);z-index:3}.paint-layout-grid{display:grid;grid-template-columns:auto auto auto;gap:1rem;align-items:start;grid-template-areas:"buttons toggles meter";height:100%;min-height:150px}.paint-main-controls{grid-area:buttons;display:flex;flex-direction:column;gap:0rem}.paint-buttons-column{display:flex;flex-direction:column;gap:.3rem;align-items:stretch;height:fit-content}.paint-buttons-column>.toolkit-button,.paint-buttons-column>.mic-device-selector{flex:0 0 auto;height:2rem;min-height:2rem;max-height:2rem}.paint-toggles-controls{grid-area:toggles;display:flex;flex-direction:column;gap:0rem;align-items:center;height:fit-content;max-height:100%}#mic-paint-toggle{background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border)}#mic-paint-toggle.active{background-color:var(--c-danger);color:var(--c-surface);border-color:var(--c-danger);font-weight:700}#paint-clear-btn{background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border)}#paint-clear-btn:disabled{opacity:.6;cursor:not-allowed;background-color:var(--c-gridline)}#paint-clear-btn:not(:disabled):hover{background-color:var(--c-warning);border-color:var(--c-warning);color:var(--c-text)}.mic-device-selector{background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);padding:var(--space-025);font-size:var(--font-size-sm);cursor:pointer}.mic-device-selector:focus{outline:2px solid var(--c-accent);outline-offset:2px}.mic-device-selector:hover{border-color:var(--c-accent)}#trail-thickness,#trail-opacity{width:45px;height:24px;background:transparent;border:none;border-radius:0;box-shadow:none;position:relative;padding:0}#trail-thickness svg,#trail-opacity svg{width:45px!important;height:24px!important}#trail-thickness circle,#trail-opacity circle{fill:var(--c-surface)!important;stroke:var(--c-border)!important;stroke-width:2!important}#trail-thickness path,#trail-opacity path{stroke:var(--c-accent)!important;fill:none!important;stroke-width:3!important}.slider-value{position:absolute;top:-8px;right:-8px;background-color:var(--c-accent);color:var(--c-surface);border-radius:50%;width:18px;height:18px;display:flex;align-items:center;justify-content:center;font-size:.65em;font-weight:700;pointer-events:none}.paint-color-toggle-container,.paint-playback-toggle-container{display:flex;flex-direction:column;align-items:flex-start;gap:var(--space-015);margin-top:var(--space-025)}.paint-color-toggle-container h5,.paint-playback-toggle-container h5{margin:0;color:var(--c-text-muted);font-size:.9em;text-transform:uppercase;letter-spacing:.5px;font-weight:600}.two-state-toggle{position:relative;width:120px;height:30px;background-color:var(--c-gridline);border:2px solid var(--c-border);border-radius:15px;cursor:pointer;-webkit-user-select:none;user-select:none;transition:all .3s ease}.two-state-slider{position:absolute;top:2px;left:2px;width:56px;height:26px;background-color:var(--c-accent);border-radius:13px;transition:transform .3s ease;box-shadow:0 2px 4px #0003}.two-state-toggle.active .two-state-slider{transform:translate(60px)}.toggle-labels{display:flex;justify-content:space-between;align-items:center;height:100%;padding:0 var(--space-025);pointer-events:none}.toggle-label{font-size:.7em;font-weight:600;color:var(--c-text-muted);transition:color .3s ease;z-index:1}.two-state-toggle:not(.active) .toggle-label:first-child,.two-state-toggle.active .toggle-label:last-child{color:var(--c-surface)}#pitch-paint-canvas{position:absolute;top:0;left:0;pointer-events:none;z-index:2}.mic-error{color:var(--c-danger);font-size:var(--font-size-sm);text-align:center;padding:var(--space-025);background-color:#dc35451a;border:1px solid var(--c-danger);border-radius:var(--border-radius-sm);margin-top:var(--space-025)}.mic-permission-prompt{text-align:center;padding:var(--space-035);color:var(--c-text-muted);font-size:var(--font-size-sm);background-color:var(--c-gridline);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);margin-top:var(--space-025)}.mic-permission-prompt button{margin-top:var(--space-025);background-color:var(--c-accent);color:var(--c-surface);border:none;padding:var(--space-025) var(--space-035);border-radius:var(--border-radius-sm);cursor:pointer;font-size:var(--font-size-sm)}.mic-permission-prompt button:hover{background-color:var(--c-accent-hover)}@media (prefers-reduced-motion: reduce){.meter-bar{transition:none}}@media (prefers-reduced-motion: reduce){*{transition:none!important;animation:none!important}}.mic-meter-container-inline{display:flex;flex-direction:column;gap:var(--space-015);margin-top:var(--space-025);padding:var(--space-025);background-color:var(--c-gridline);border-radius:var(--border-radius-md);border:1px solid var(--c-border)}.mic-meter-header-inline{display:flex;justify-content:space-between;align-items:center}.meter-label{font-size:var(--font-size-sm);color:var(--c-text);font-weight:600}.meter-settings-btn-small{padding:var(--space-015);font-size:var(--font-size-xs);min-width:auto;width:24px;height:24px;display:flex;align-items:center;justify-content:center}.mic-meter-wrapper-inline{position:relative;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);overflow:hidden;height:36px}.mic-meter-container{margin-top:var(--space-050);border-top:1px solid var(--c-border);padding-top:var(--space-035)}.mic-meter-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-025)}.mic-meter-header h5{margin:0;font-size:var(--font-size-sm);color:var(--c-text);font-weight:600}.meter-controls{display:flex;gap:var(--space-015)}.meter-settings-btn{padding:var(--space-015);font-size:var(--font-size-sm);min-width:auto;width:28px;height:28px;display:flex;align-items:center;justify-content:center}.mic-meter-wrapper,.mic-meter-wrapper-inline{position:relative;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);overflow:hidden}.mic-meter-wrapper.compact{height:48px}.mic-meter-wrapper.wide{height:72px}.mic-meter-wrapper-inline{height:36px}.mic-meter-container-vertical{grid-area:meter;display:flex;flex-direction:column;gap:var(--space-025);padding:0 var(--space-025);border-left:1px solid var(--c-border-light);border-right:1px solid var(--c-border-light);width:3.5rem;height:100%;align-self:stretch}.mic-meter-header-vertical{display:flex;align-items:center;justify-content:space-between;font-size:var(--font-size-sm);color:var(--c-text);font-weight:600}.mic-meter-wrapper-vertical{flex:1;position:relative;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);overflow:hidden;min-height:150px}.meter-placeholder{display:flex;align-items:center;justify-content:center;height:100%;background-color:var(--c-gridline);opacity:.6}.meter-placeholder.disabled{opacity:.4}.meter-status-text{font-size:var(--font-size-xs);color:var(--c-text-muted);text-align:center;padding:var(--space-015)}.mic-meter-wrapper-inline .meter-status-text{font-size:10px;padding:var(--space-015)}.mic-meter-wrapper.active .meter-placeholder,.mic-meter-wrapper-inline.active .meter-placeholder{display:none}.mic-meter-wrapper canvas,.mic-meter-wrapper-inline canvas{display:block;width:100%;height:100%;background-color:var(--c-surface)}.meter-settings-panel{margin-top:var(--space-025);padding:var(--space-035);background-color:var(--c-gridline);border-radius:var(--border-radius-md);border:1px solid var(--c-border)}.meter-settings-panel.hidden{display:none}.meter-setting-group{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-025)}.meter-setting-group:last-child{margin-bottom:0;gap:var(--space-025)}.meter-setting-group label{font-size:var(--font-size-sm);color:var(--c-text);font-weight:500;min-width:80px}.meter-control{padding:var(--space-015) var(--space-025);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);background-color:var(--c-surface);color:var(--c-text);font-size:var(--font-size-sm)}.meter-control:focus{outline:2px solid var(--c-warning);outline-offset:2px}.meter-error{background-color:#f8d7da;border-color:var(--c-danger)}.meter-error .meter-status-text{color:var(--c-danger)}.meter-permission-prompt{padding:var(--space-035);text-align:center;background-color:#fff3cd;border:1px solid var(--c-warning);border-radius:var(--border-radius-md);margin-top:var(--space-025)}.meter-permission-prompt p{margin:0 0 var(--space-025) 0;font-size:var(--font-size-sm);color:var(--c-text)}.meter-permission-prompt button{background-color:var(--c-warning);color:var(--c-text);border:none;padding:var(--space-025) var(--space-035);border-radius:var(--border-radius-sm);font-size:var(--font-size-sm);cursor:pointer}.meter-permission-prompt button:hover{background-color:#e0a800}.draw-content-box{display:flex;flex-direction:column;gap:var(--space-035);padding:var(--space-015);width:100%;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-sm);position:relative;z-index:1}.draw-tools-row{display:flex;flex-direction:row;gap:var(--space-025);justify-content:center;align-items:center}.draw-tool-button{width:2.5rem;height:2.5rem;padding:var(--space-015);display:flex;align-items:center;justify-content:center;background-color:var(--c-surface);border:2px solid var(--c-border);border-radius:var(--border-radius-md);cursor:pointer;transition:all .2s ease;color:var(--c-text-muted)}.draw-tool-button:hover{background-color:var(--c-gridline);border-color:var(--c-text-muted);transform:scale(1.05)}.draw-tool-button.active{background-color:var(--c-accent, #4a90e2);border-color:var(--c-accent, #4a90e2);color:var(--c-surface)}.draw-tool-button svg{width:100%;height:100%}.draw-tool-options{display:flex;flex-direction:column;gap:var(--space-025);padding:var(--space-015);background-color:var(--c-bg);border:1px solid var(--c-border);border-radius:var(--border-radius-md);min-height:auto}.draw-tool-options:empty{display:none}.draw-toolbar-row{display:flex;gap:var(--space-015);align-items:center;justify-content:center}.draw-toolbar-button{width:2rem;height:2rem;padding:var(--space-015);display:flex;align-items:center;justify-content:center;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);cursor:pointer;transition:all .2s ease;color:var(--c-text)}.draw-toolbar-button:hover{background-color:var(--c-gridline);border-color:var(--c-text-muted)}.draw-toolbar-button svg{width:100%;height:100%}.draw-popup-menu{position:absolute;display:flex;flex-direction:column;gap:var(--space-015);padding:var(--space-015);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-md);z-index:1000}.draw-popup-option{padding:var(--space-015);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;min-width:40px}.draw-popup-option:hover{background-color:var(--c-gridline);border-color:var(--c-text-muted)}.draw-popup-option.active{background-color:var(--c-gridline);border-color:var(--c-accent, #4a90e2);border-width:2px;color:var(--c-text)}.draw-popup-option.active svg,.draw-popup-option.active svg *{stroke:var(--c-accent, #4a90e2)}.draw-popup-option svg{display:block;stroke:var(--c-text)}.draw-popup-option svg *{stroke:var(--c-text)}.draw-option-group{display:flex;flex-direction:column;gap:var(--space-015)}.draw-option-label{font-size:var(--font-size-sm);font-weight:600;color:var(--c-text-muted);text-transform:uppercase;letter-spacing:.5px}.draw-button-group{display:flex;gap:var(--space-015);flex-wrap:wrap}.draw-option-button{padding:var(--space-015) var(--space-025);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);cursor:pointer;font-size:var(--font-size-sm);color:var(--c-text);transition:all .2s ease}.draw-option-button:hover{background-color:var(--c-gridline);border-color:var(--c-text-muted)}.draw-option-button.active{background-color:var(--c-accent, #4a90e2);border-color:var(--c-accent, #4a90e2);color:var(--c-surface)}.draw-swap-button{padding:var(--space-015);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);cursor:pointer;display:flex;align-items:center;justify-content:center}.draw-swap-button:hover{background-color:var(--c-gridline)}.draw-color-picker{display:flex;gap:var(--space-015)}.draw-color-button{width:2rem;height:2rem;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s ease}.draw-color-button:hover{transform:scale(1.1);border-color:var(--c-text-muted)}.draw-color-button.active{border-color:var(--c-text);border-width:3px;transform:scale(1.1)}.draw-stroke-size-group{display:flex;gap:var(--space-015)}.draw-stroke-size-button{width:3rem;padding:var(--space-015);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);cursor:pointer;font-size:var(--font-size-sm);transition:all .2s ease}.draw-stroke-size-button:hover{background-color:var(--c-gridline);border-color:var(--c-text-muted)}.draw-stroke-size-button.active{background-color:var(--c-accent, #4a90e2);border-color:var(--c-accent, #4a90e2);color:var(--c-surface)}.annotation-text-input{caret-color:#4a90e2;user-select:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text}.annotation-text-input::selection{background-color:#4a90e2;color:#fff}.adsr-container{display:grid;grid-template-columns:auto auto;grid-template-rows:1fr auto;gap:0;overflow:visible;padding:5px 0 0 5px;flex:1 1 auto;min-height:0;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md)}.adsr-graph-wrapper{grid-column:1;grid-row:1;position:relative;border:1px solid var(--c-border);border-radius:var(--border-radius-sm);overflow:visible;min-height:0}#adsr-envelope{position:relative;width:100%;height:100%;overflow:visible}#adsr-envelope svg{display:block;width:100%;height:100%;background-color:var(--c-surface)}.sustain-slider-wrapper{grid-column:2;grid-row:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding-inline:0rem;width:fit-content;min-width:var(--slider-thumb-size)}#sustain-slider-track{position:relative;width:var(--slider-track-thickness);height:100%;background-color:var(--c-gridline);border-radius:var(--border-radius-sm)}#sustain-slider-track:before{content:"";position:absolute;bottom:0;left:0;width:100%;height:var(--sustain-progress, 0%);background-color:var(--c-accent);border-radius:var(--border-radius-sm)}#sustain-slider-track:after{content:"";position:absolute;top:0;left:0;width:100%;height:var(--ineligible-height, 0%);background-color:#80808066;border-radius:var(--border-radius-sm);pointer-events:none}#sustain-slider-thumb{position:absolute;left:50%;transform:translate(-50%,50%);width:var(--slider-thumb-size);height:var(--slider-thumb-size);background-color:var(--c-accent);border-radius:50%;border:var(--slider-thumb-border) solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:grab;color:var(--c-surface);font-size:12px;font-weight:700;display:flex;justify-content:center;align-items:center;-webkit-user-select:none;user-select:none}#sustain-slider-thumb:active{cursor:grabbing;background-color:var(--c-accent-hover);transform:translate(-50%,50%) scale(1.1)}#multi-thumb-slider-container{grid-column:1;grid-row:2;position:relative;width:100%;height:var(--slider-track-thickness);min-height:var(--slider-thumb-size);display:flex;align-items:center}#multi-thumb-slider-container:before{content:"";position:absolute;left:0;right:0;height:var(--slider-track-thickness);border-radius:var(--border-radius-sm);background:linear-gradient(to right,var(--c-accent) var(--adr-progress, 0%),var(--c-gridline) var(--adr-progress, 0%))}.time-slider-thumb{position:absolute;top:50%;transform:translate(-50%,-50%);width:var(--slider-thumb-size);height:var(--slider-thumb-size);background-color:var(--c-accent);border-radius:50%;border:var(--slider-thumb-border) solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:grab;color:var(--c-surface);font-size:12px;font-weight:700;display:flex;justify-content:center;align-items:center;-webkit-user-select:none;user-select:none}.time-slider-thumb:active{cursor:grabbing;background-color:var(--c-accent-hover);transform:translate(-50%,-50%) scale(1.1)}.filter-container{display:grid;grid-template-columns:auto auto;grid-template-rows:auto 1fr auto;gap:0;flex:1 1 auto;margin-left:0;min-height:0;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);padding:0 0 0 5px}.blend-slider-container{grid-column:1;grid-row:1;display:flex;align-items:center;margin:0;padding:0;min-height:var(--slider-thumb-size)}.filter-bins-wrapper{grid-column:1;grid-row:2;display:flex;min-height:0}.filter-vertical-blend-wrapper{grid-column:2;grid-row:2;display:flex;align-items:center;justify-content:center;min-height:0;min-width:var(--slider-thumb-size)}#filter-enable-toggle{flex-shrink:0;background-color:var(--c-gridline);color:var(--c-text-muted);border:1px solid var(--c-border);display:none}#filter-enable-toggle .filter-icon{width:24px;height:24px}#filter-enable-toggle.active{background-color:var(--c-accent);color:var(--c-surface);border-color:var(--c-accent-hover)}#blend-slider-container,#cutoff-slider-container{position:relative;width:100%;height:var(--slider-track-thickness);min-height:var(--slider-thumb-size);display:flex;align-items:center;flex-shrink:0}#blend-slider-container:before,#cutoff-slider-container:before{content:"";position:absolute;left:0;right:0;height:var(--slider-track-thickness);border-radius:var(--border-radius-sm);background:linear-gradient(to right,var(--c-accent) var(--progress, 0%),var(--c-gridline) var(--progress, 0%))}#cutoff-slider-container{grid-column:1;grid-row:3;transition:opacity .2s;margin:0;padding:0}.filter-cutoff-thumb,.filter-blend-thumb{position:absolute;top:50%;transform:translate(-50%,-50%);width:var(--slider-thumb-size);height:var(--slider-thumb-size);font-size:12px;background-color:var(--c-accent);border-radius:50%;border:var(--slider-thumb-border) solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:grab;color:var(--c-surface);font-weight:700;display:flex;justify-content:center;align-items:center;-webkit-user-select:none;user-select:none;z-index:5}.filter-cutoff-thumb:active,.filter-blend-thumb:active{cursor:grabbing;background-color:var(--c-accent-hover);transform:translate(-50%,-50%) scale(1.1)}.vertical-blend-wrapper{display:flex;flex-direction:column;align-items:center;justify-content:center;width:fit-content;min-width:var(--slider-thumb-size);height:100%;margin:0;padding:0}#vertical-blend-track{position:relative;width:var(--slider-track-thickness);height:100%;background:linear-gradient(to top,var(--c-accent) var(--blend-progress, 0%),var(--c-gridline) var(--blend-progress, 0%));border-radius:var(--border-radius-sm);cursor:pointer}#vertical-blend-thumb{position:absolute;left:50%;transform:translate(-50%,50%);width:var(--slider-thumb-size);height:var(--slider-thumb-size);background-color:var(--c-accent);border-radius:50%;border:var(--slider-thumb-border) solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:ns-resize;color:var(--c-surface);font-size:12px;font-weight:700;display:flex;justify-content:center;align-items:center;-webkit-user-select:none;user-select:none;z-index:5}#vertical-blend-thumb:active{cursor:ns-resize;background-color:var(--c-accent-hover);transform:translate(-50%,50%) scale(1.1)}.harmonic-bins-grid{display:flex;flex-direction:row;flex:1 1 auto;min-width:11rem;height:100%;min-height:60px;max-height:7.8rem;position:relative;gap:0;padding:0;margin:0;border:1px solid var(--c-border);border-radius:2px;overflow:hidden}.slider-column{display:flex;flex-direction:column;flex:1;align-items:center;min-width:0;margin:0;padding:0;gap:0}.harmonic-label{font-size:.7rem;color:var(--c-text-muted);text-align:center;height:16px;display:flex;align-items:center;justify-content:center}.harmonic-label-internal{position:absolute;bottom:2px;left:50%;transform:translate(-50%);font-size:.8rem;font-weight:600;text-align:center;z-index:3;pointer-events:none;transition:color .1s ease,text-shadow .1s ease;-webkit-user-select:none;user-select:none}.slider-track{flex-grow:1;width:100%;background-color:#fff;border:none;border-radius:0;position:relative;cursor:pointer;margin:0;padding:0;min-height:0;display:flex;flex-direction:column;justify-content:flex-end;pointer-events:auto}.slider-snap-zone{position:absolute;bottom:0;left:0;right:0;height:10%;background-color:#f7f7f7;border-top:1px solid var(--c-border)}.slider-fill{position:absolute;bottom:0;left:0;right:0;background-color:transparent;transition:height .1s ease;border-radius:0 0 1px 1px}.phase-button{background-color:var(--c-gridline);color:var(--c-text-muted);border:1px solid var(--c-border);border-radius:3px;margin:0;padding:0;cursor:pointer;display:flex;align-items:center;justify-content:center;width:20px;height:20px;flex-shrink:0;position:relative}.phase-button:hover{background-color:var(--c-border);color:var(--c-text)}.phase-button svg{width:100%;height:100%}.filter-overlay-canvas{position:absolute;top:0;left:0;width:100%;height:calc(100% - 24px);pointer-events:none;z-index:2}.multislider-container.filter-disabled #blend-slider-container,.multislider-container.filter-disabled #cutoff-slider-container{opacity:.5;pointer-events:none}.multislider-container.filter-disabled .filter-overlay-canvas{display:none}.static-waveform-container{margin-bottom:.52em}.static-waveform-container h4{margin:0;font-size:.875rem;font-weight:600;color:var(--c-text, #212529)}.waveform-display-wrapper{position:relative;width:auto;height:100%;max-height:100%;aspect-ratio:1 / 1;flex-shrink:1;border:1px solid var(--c-border, #dee2e6);border-radius:6px;background:var(--c-surface, #ffffff);overflow:hidden;box-shadow:inset 0 1px 3px #0000001a;transition:all .2s ease;transform:translateZ(0)}.waveform-display-wrapper.live-mode{border-color:var(--c-accent, #4A90E2);box-shadow:inset 0 1px 3px #0000001a,0 0 0 2px #4a90e21a}#static-waveform-canvas{display:block;width:100%;height:100%;cursor:default}.waveform-display-wrapper:after{content:"";position:absolute;top:6px;right:6px;width:8px;height:8px;border-radius:50%;background:#28a745;opacity:0;transition:opacity .3s ease;z-index:10}.waveform-display-wrapper.live-mode:after{opacity:1}.timbre-panel .static-waveform-container{margin:0}@keyframes waveform-pulse{0%,to{box-shadow:inset 0 1px 3px #0000001a,0 0 0 2px #4a90e21a}50%{box-shadow:inset 0 1px 3px #0000001a,0 0 0 2px #4a90e233}}.waveform-display-wrapper.live-mode.pulsing{animation:waveform-pulse 2s ease-in-out infinite}@media (max-width: 768px){.waveform-display-wrapper{height:80px}.static-waveform-container h4{font-size:.8rem}}@media (prefers-color-scheme: dark){.waveform-display-wrapper{background:var(--c-surface-dark, #2d3748);border-color:var(--c-border-dark, #4a5568)}.static-waveform-container h4{color:var(--c-text-dark, #e2e8f0)}.waveform-display-wrapper.live-mode{border-color:var(--c-accent, #4A90E2);box-shadow:inset 0 1px 3px #0003,0 0 0 2px #4a90e226}}.static-waveform-container .control-section{padding:0}#timbre-panel .static-waveform-container{border-top:1px solid var(--c-border-light, #f1f3f4);border-bottom:1px solid var(--c-border-light, #f1f3f4);padding-top:0rem;padding-bottom:0;margin-top:.2rem;margin-bottom:.2rem}.waveform-display-wrapper:not(.live-mode){background-image:linear-gradient(90deg,rgba(0,0,0,.02) 1px,transparent 1px),linear-gradient(rgba(0,0,0,.02) 1px,transparent 1px);background-size:20px 10px;background-position:0 0,0 0}.waveform-display-wrapper *{transition:opacity .2s ease}#static-waveform-canvas.loading{opacity:.5;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:loading-shimmer 1.5s infinite}@keyframes loading-shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}@media (prefers-contrast: high){.waveform-display-wrapper{border-width:2px;border-color:#000}.waveform-display-wrapper.live-mode{border-color:#06c;box-shadow:0 0 0 3px #0066cc4d}}.waveform-speed-controls{position:absolute;top:8px;right:8px;display:flex;gap:4px;z-index:20}.waveform-speed-btn{padding:var(--space-010);font-size:.7rem;font-weight:500;background-color:#fff;color:var(--c-text);border-radius:var(--border-radius-sm);cursor:pointer;transition:all .2s ease;min-width:24px;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.waveform-speed-btn:hover{background-color:var(--c-border)}.waveform-speed-btn.active{background-color:var(--c-accent-light, #63a9fd)!important;color:var(--c-text, #212529)!important;border-color:var(--c-accent, #4A90E2)!important;font-weight:600!important;box-shadow:0 0 0 1px var(--c-accent, #4A90E2)!important;transform:scale(.98)!important}.waveform-speed-btn.active:hover{background-color:var(--c-accent-light, #63a9fd)!important;color:var(--c-text, #212529)!important;border-color:var(--c-accent, #4A90E2)!important}.waveform-speed-controls{opacity:1;pointer-events:auto}@media (prefers-color-scheme: dark){.waveform-speed-btn,.waveform-toggle-btn{background-color:var(--c-surface-dark, #2d3748);border-color:var(--c-border-dark, #4a5568);color:var(--c-text-dark, #e2e8f0)}.waveform-speed-btn:hover,.waveform-toggle-btn:hover{background-color:var(--c-border-dark, #4a5568)}}@media (prefers-reduced-motion: reduce){.waveform-display-wrapper,.waveform-display-wrapper:after,.waveform-display-wrapper *,.waveform-speed-btn{transition:none;animation:none}}.note.selected{background-color:var(--note-color, #000)}.note-pair.selected{border-color:var(--note-color)!important;box-shadow:0 0 8px var(--note-color)}.note-pair[data-color="#4a90e2"].selected{--note-color: #4a90e2}.note-pair[data-color="#2d2d2d"].selected{--note-color: #2d2d2d}.note-pair[data-color="#d66573"].selected{--note-color: #d66573}.note-pair[data-color="#68a03f"].selected{--note-color: #68a03f}.toolkit-icon-button.selected,.toolkit-icon-button.active:not(#grid-zoom-in):not(#grid-zoom-out):not(#clear-button):not(#undo-button):not(#redo-button):not(#stop-button):not(#play-button){background-color:var(--c-accent);color:var(--c-surface)}.toolkit-icon-button.selected img,.toolkit-icon-button.active:not(#grid-zoom-in):not(#grid-zoom-out):not(#clear-button):not(#undo-button):not(#redo-button):not(#stop-button):not(#play-button) img{filter:invert(1) brightness(2)}.eraser-button.selected{background-color:var(--c-danger);color:var(--c-surface);box-shadow:none}.eraser-button.selected img{filter:invert(1) brightness(2)}.toolkit-icon-button.selected:hover,.toolkit-icon-button.active:hover{background-color:var(--c-accent-hover);transform:scale(1)}.eraser-button.selected:hover{background-color:#a72836}.eraser-button.erasing-active{background-color:var(--c-danger);color:var(--c-surface);transform:scale(1)}.eraser-button.erasing-active img{filter:invert(1) brightness(2)}.toolkit-icon-button.flash{background-color:#dc35454d;box-shadow:0 0 8px var(--c-danger);animation:clearFlash .3s ease-out}@keyframes clearFlash{0%{background-color:#dc354599;box-shadow:0 0 12px var(--c-danger)}to{background-color:transparent;box-shadow:none}}.preset-button.selected{background-color:var(--c-accent);color:var(--c-surface);border:1px solid var(--c-accent-hover);box-shadow:0 0 5px var(--c-accent)}.preset-button.selected:hover{background-color:var(--c-accent-hover)}#volume-icon-button.active{background-color:var(--c-border)!important;color:var(--c-text)!important}#volume-icon-button.active img{filter:none!important}#volume-icon-button.active:hover{background-color:var(--c-gridline)!important;color:var(--c-text)!important}#clear-button:active,#eraser-tool-button:active{background-color:#dc35454d!important;transform:scale(.92);transition-duration:.05s}#loop-button.active{background-color:var(--c-warning)!important;color:var(--c-text)!important}#loop-button.active img{filter:none!important}#loop-button.active:hover{background-color:#e6ac00!important;color:var(--c-text)!important}
