:root{--c-bg: #f8f9fa;--c-surface: #ffffff;--c-text: #212529;--c-text-muted: #6c757d;--c-border: #dee2e6;--c-gridline: #e9ecef;--c-accent: #4A90E2;--c-accent-hover: #357ABD;--c-danger: #dc3545;--c-warning: #ffc107;--space-1: .25em;--space-2: .5em;--space-3: .75em;--space-4: 1em;--space-5: 1.25em;--app-padding: var(--space-2);--note-size: 1.75em;--note-margin: var(--space-1);--border-radius-sm: 4px;--border-radius-md: 8px;--box-shadow-sm: 0 1px 2px rgba(0, 0, 0, .05);--box-shadow-md: 0 4px 6px rgba(0, 0, 0, .1);--main-font: "Atkinson Hyperlegible", Arial, sans-serif;--font-size-sm: .875rem;--font-size-base: 1rem;--font-size-lg: 1.125rem}@font-face{font-family:Atkinson Hyperlegible;src:url(/Student-Notation/assets/AtkinsonHyperlegibleNext-Regular-DOJsAlq1.otf) format("opentype");font-weight:400;font-style:normal}*,*:before,*:after{box-sizing:border-box}html,body{margin:0;padding:0;height:100%;width:100%;overflow-x:auto;overflow-y:hidden;font-family:var(--main-font);background-color:var(--c-gridline);color:var(--c-text);display:flex}button{background-color:var(--c-accent);color:var(--c-surface);border:none;border-radius:var(--border-radius-md);padding:8px 12px;font-family:var(--main-font);font-size:14px;cursor:pointer;transition:background-color .2s,opacity .2s}button:hover,button:focus{background-color:var(--c-accent-hover);outline:none}button:disabled{background-color:var(--c-border);opacity:.7;cursor:not-allowed}:root{font-size:125%}body{font-size:var(--font-size-base)}button{font-size:var(--font-size-sm)}.slider-label{font-size:var(--font-size-base)}.tempo-input{font-size:var(--font-size-sm)}.app-title{font-size:var(--font-size-base)}.time-signature-label,.rhythm-ui-button{font-size:var(--font-size-sm)}.tonic-sign-button{font-size:var(--font-size-lg)}#app-container{display:flex;flex-direction:column;flex:1;min-height:0;width:100vw;overflow-x:visible}#canvas-container{height:80vh;display:flex;min-height:0;width:fit-content;min-width:100%;overflow-x:visible;padding:0 var(--app-padding) var(--app-padding);position:relative;z-index:1}#canvas-content{display:flex;flex-direction:column;flex:1;min-width:fit-content;overflow-x:visible;height:100%}#toolbar{height:20vh;min-height:170px;width:fit-content;display:flex;gap:var(--space-1);padding:.4em .4em 0;border:none;background-color:transparent;box-shadow:none;flex-shrink:0;margin-bottom:0;position:relative;z-index:2}#container-1,#container-2,#container-3{display:flex;border:1px solid var(--c-border);border-radius:var(--border-radius-md);background-color:var(--c-bg)}#container-1{padding:.5em;flex:0 0 0;gap:0;align-items:stretch}#container-2{padding:var(--space-2);width:13.5em;flex-shrink:0;flex-direction:column;gap:var(--space-2);justify-content:space-around}.tool-subcontainer{display:flex;flex-direction:column;gap:var(--space-1);align-items:center;padding:var(--space-2);background-color:transparent;border-radius:0;border-right:1px solid var(--c-border);height:100%;justify-content:center}.tool-subcontainer:last-child,.control-section:last-child{border-right:none}#container-3{flex:1 1 0;overflow:visible;min-width:0;padding:0}.tab-sidebar{flex:0 0 100px;display:flex;flex-direction:column;background-color:var(--c-gridline);border-right:1px solid var(--c-border)}.tab-content{flex:1;padding:.1em;background-color:var(--c-bg);overflow:visible;min-width:0}.tab-panel{display:none;height:100%;align-items:stretch}.tab-panel.active{display:flex;gap:var(--space-2)}.control-section{flex:0 1 auto;padding:.2em;background-color:transparent;border-right:none;display:flex;flex-direction:column;min-width:fit-content;width:fit-content;border-radius:0}.preset-container{align-items:center;justify-content:center;flex:0 0 auto;width:fit-content}.control-section h4{margin:0 0 var(--space-1) 0;color:var(--c-text-muted);font-size:.9em;text-transform:uppercase;letter-spacing:.5px;flex-shrink:0;width:100%}#pitch-grid-wrapper{width:fit-content;min-width:100%;display:flex;flex-direction:column;flex:1 0 auto;min-height:200px;overflow:hidden;border:1px solid var(--c-border);border-bottom:none;border-radius:var(--border-radius-md) var(--border-radius-md) 0 0;position:relative;background-color:var(--c-surface)}#time-signature-display,#canvas-macrobeat-tools{flex-shrink:0}#pitch-grid-container{flex:1;position:relative;width:fit-content;overflow-x:visible;overflow-y:hidden;min-height:0}#grid-container{position:relative;height:100%;width:fit-content}#pitch-canvas-wrapper{position:absolute;top:0;left:0;width:100%;height:100%}#notation-grid,#playhead-canvas,#hover-canvas,#pitch-paint-canvas{position:absolute;top:0;left:0;display:block}#playhead-canvas,#hover-canvas,#drum-hover-canvas,#pitch-paint-canvas{pointer-events:none}#harmonyAnalysisGrid{flex:0 0 auto;width:fit-content;min-height:40px;position:relative;background-color:var(--c-gridline);border-left:1px solid var(--c-border);border-right:1px solid var(--c-border)}#harmony-analysis-canvas{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}#drum-grid-wrapper{flex:0 0 auto;width:fit-content;min-height:90px;overflow:hidden;position:relative;border:1px solid var(--c-border);border-top:none;border-radius:0 0 var(--border-radius-md) var(--border-radius-md)}#drum-grid,#drum-hover-canvas{display:block;position:absolute;top:0;left:0}#sidebar{position:fixed;top:0;left:0;width:250px;height:100%;background-color:#f8f9faf2;border-right:1px solid var(--c-border);box-shadow:var(--box-shadow-md);padding:var(--space-4);display:flex;flex-direction:column;gap:var(--space-4);z-index:2000;transform:translate(-100%);transition:transform .3s ease-in-out;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}body.sidebar-open #sidebar{transform:translate(0)}.sidebar-container{border:1px solid var(--c-border);border-radius:var(--border-radius-md);padding:var(--space-3);background-color:var(--c-surface)}.sidebar-container .app-title{text-align:center;font-weight:700;line-height:1.2;color:var(--c-text-muted)}.sidebar-button{display:block;width:100%;padding:var(--space-2) var(--space-3);text-align:left;margin-bottom:var(--space-2)}.sidebar-button:last-child{margin-bottom:0}#sidebar-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;z-index:1999;opacity:0;visibility:hidden;transition:opacity .3s ease-in-out,visibility .3s ease-in-out}body.sidebar-open #sidebar-overlay{opacity:1;visibility:visible}#volume-control-wrapper{position:relative}#volume-popup{position:absolute;top:100%;left:50%;transform:translate(-50%);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);padding:var(--space-3) var(--space-2);margin-top:var(--space-2);box-shadow:var(--box-shadow-sm);z-index:1001;visibility:hidden;opacity:0;transition:opacity .2s,visibility .2s}#volume-popup.visible{visibility:visible;opacity:1}input[type=range][orient=vertical]{-moz-appearance:none;appearance:none;-webkit-appearance:none;writing-mode:vertical-lr;direction:rtl;width:8px;height:120px;padding:0 5px}#print-preview-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0009;display:flex;justify-content:center;align-items:center;z-index:1000;opacity:1;transition:opacity .3s ease}#print-preview-overlay.hidden{opacity:0;pointer-events:none}#print-preview-modal{background-color:var(--c-surface);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-md);width:80vw;height:80vh;display:flex;flex-direction:column}.print-preview-header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;border-bottom:1px solid var(--c-border);flex-shrink:0}.print-preview-header h2{margin:0;font-size:18px}.print-preview-content{flex-grow:1;display:flex;gap:20px;padding:20px;min-height:0}.print-preview-canvas-wrapper{flex-grow:1;border:1px dashed var(--c-border);background-color:var(--c-bg);overflow:auto;padding:10px}#print-preview-canvas{display:block;background-color:#fff}.print-preview-options{flex-basis:280px;flex-shrink:0;display:flex;flex-direction:column;gap:15px}.print-option-row{display:grid;grid-template-columns:90px 40px 1fr;align-items:center;gap:10px}.print-option-row label{font-weight:700}.print-option-row span{font-family:monospace;font-size:12px}.print-preview-options h3{margin-top:10px;margin-bottom:5px;border-bottom:1px solid var(--c-gridline);padding-bottom:5px}.print-preview-footer{padding:10px 20px;border-top:1px solid var(--c-border);text-align:right;flex-shrink:0}.close-button{background:none;border:none;font-size:24px;line-height:1;padding:0 5px;color:var(--c-text-muted);cursor:pointer}.confirm-button{background-color:#28a745;font-weight:700}.confirm-button:hover{background-color:#218838}.toggle-button{width:100%;grid-column:2 / -1}.toggle-button.active{background-color:var(--c-accent)}.toggle-button:not(.active){background-color:var(--c-gridline);color:var(--c-text)}#chord-candidate-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:transparent;z-index:1001}#chord-candidate-menu{position:fixed;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-md);z-index:1002;padding:var(--space-2);transform:translate(-50%,10px);opacity:0;transition:transform .2s ease-out,opacity .2s ease-out}#chord-candidate-menu:not(.hidden){transform:translate(-50%,-100%);opacity:1}#chord-candidate-menu.hidden,#chord-candidate-overlay.hidden{display:none}#chord-candidate-list{display:flex;flex-direction:column;gap:var(--space-1);max-height:200px;overflow-y:auto}.chord-candidate-button{background-color:var(--c-gridline);color:var(--c-text);text-align:left;padding:var(--space-2) var(--space-3);font-size:14px}.chord-candidate-button.is-primary{background-color:var(--c-accent);color:var(--c-surface);font-weight:700}.chord-candidate-button:hover{background-color:var(--c-accent-hover);color:var(--c-surface)}@media print{body>#app-container,body>#print-preview-overlay{display:none!important}#print-staging-area{display:block!important;visibility:visible!important;margin:0;padding:0}#print-staging-area img{display:block!important;visibility:visible!important;width:100%;height:auto}}#print-staging-area{display:none}#harmony-toolkit-container{display:flex;align-items:center;justify-content:center;padding:0 var(--space-2)}#x-chord-shape-tool{width:40px;height:40px;font-size:20px;font-weight:700;padding:0;border:1px solid var(--c-border);background-color:var(--c-surface);color:var(--c-text);border-radius:var(--border-radius-sm)}#x-chord-shape-tool.selected{border:2px solid var(--c-accent);box-shadow:0 0 5px var(--c-accent)}#chord-toolbar-wrapper{background-color:var(--c-gridline);border:1px solid var(--c-border);border-radius:var(--border-radius-md);display:flex;align-items:center;padding:var(--space-1);margin-top:var(--space-2);width:100%;box-shadow:none;transition:opacity .2s}#chord-toolbar-wrapper.collapsed{display:none}.chord-toolbar-panel{display:flex;gap:var(--space-1)}.chord-toolbar-panel select{padding:var(--space-1);border-radius:var(--border-radius-sm);border:1px solid var(--c-border);background-color:var(--c-bg);transition:border-color .2s}.chord-toolbar-panel select option:disabled{color:var(--c-text-muted);opacity:.5;pointer-events:none}.chord-toolbar-panel select.invalid-reset{border-color:var(--c-danger);box-shadow:0 0 3px var(--c-danger)}#chord-toolbar-collapse-btn{background:none;border:none;color:var(--c-text-muted);font-size:16px;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:var(--border-radius-sm)}#chord-toolbar-collapse-btn:hover{background-color:var(--c-gridline)}.tonic-dropdown-toggle{display:flex;align-items:center;gap:var(--space-2);width:60px;justify-content:center;background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border)}.dropdown-menu{display:none;position:absolute;top:100%;left:0;background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-md);z-index:100;padding:var(--space-1);flex-direction:column;gap:var(--space-1)}.dropdown-menu .tonic-sign-button{width:100%;border:2px solid transparent}.dropdown-menu .tonic-sign-button.selected{border-color:var(--c-accent)!important;background-color:var(--c-accent-hover);color:var(--c-surface)}.tonic-dropdown-toggle.selected{border:2px solid var(--c-accent);box-shadow:0 0 5px var(--c-accent)}#degree-dropdown-wrapper{position:relative}.degree-dropdown-toggle{width:100%;display:flex;justify-content:center;align-items:center;gap:var(--space-2)}#degree-dropdown-menu{top:100%;left:0;width:100%;margin-top:var(--space-1)}#degree-dropdown-menu .toolkit-button{width:100%;justify-content:center;line-height:initial;padding:var(--space-2)}#degree-dropdown-menu .toolkit-button.active{background-color:var(--c-accent);color:var(--c-surface);border:1px solid var(--c-accent-hover)}#degree-dropdown-menu .toolkit-button:not(.active){background-color:var(--c-surface);color:var(--c-text)}input[type=range]{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:100%;height:var(--space-2);border-radius:var(--border-radius-sm);background:var(--c-gridline);outline:none;margin-block-start:var(--space-2);margin-block-end:0}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:18px;height:18px;border-radius:50%;background:var(--c-accent);border:2px solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:pointer}input[type=range]::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:var(--c-accent);border:2px solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:pointer}.slider-label{margin-block-start:var(--space-2);color:var(--c-text-muted);text-align:center;-webkit-user-select:none;user-select:none}.tab-button{padding:var(--space-2) var(--space-3);background-color:transparent;border:1px solid transparent;border-bottom-color:var(--c-border);color:var(--c-text-muted);font-family:var(--main-font);font-size:1.41em;font-weight:500;cursor:pointer;text-align:left;transition:all .2s ease;position:relative;border-top-left-radius:var(--border-radius-md);border-bottom-left-radius:var(--border-radius-md)}.tab-button:hover{background-color:#0000000d;color:var(--c-text)}.tab-button.active{background-color:var(--c-bg);color:var(--c-accent);font-weight:600;margin-right:-1px;position:relative;z-index:1;border-color:var(--c-border);border-right-color:transparent;border-top-right-radius:0;border-bottom-right-radius:0}.toolkit-button{line-height:1.2;padding:var(--space-2)}.toolkit-icon-button{font-size:16px;width:42px;height:42px;padding:var(--space-1);display:flex;align-items:center;justify-content:center;background-color:transparent;border:none;color:var(--c-text-muted);border-radius:var(--border-radius-md);transition:background-color .2s,transform .1s ease}.toolkit-icon-button img{width:100%;height:100%;object-fit:contain;pointer-events:none}.toolkit-icon-button:hover{background-color:var(--c-gridline)}.toolkit-icon-button:focus{background-color:var(--c-gridline);outline:none}.toolkit-icon-button:active{transform:scale(.92);background-color:#00000026;transition-duration:.05s}.sidebar-button{background-color:transparent;border:none;border-radius:var(--border-radius-md);width:48px;height:48px;padding:var(--space-2);margin-bottom:var(--space-2);display:flex;align-items:center;justify-content:center}.sidebar-button:hover{background-color:var(--c-gridline)}.sidebar-button img{width:100%;height:100%;object-fit:contain;display:block;margin:0 auto}.preset-grid{display:flex;gap:var(--space-2)}.preset-column{display:flex;flex-direction:column;gap:var(--space-1)}.preset-button{width:95px;justify-content:center;display:flex;align-items:center;padding:var(--space-1);background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.preset-button:hover{background-color:var(--c-border)}.playback-row{display:flex;flex-direction:column;align-items:stretch;justify-content:center;gap:var(--space-2);padding:var(--space-1)}.playback-row .toolkit-icon-button{flex:1;text-align:center;justify-content:center}#accidental-controls-container-v2{display:flex;justify-content:center;gap:var(--space-2)}.accidental-button{width:40px;height:40px;font-size:22px;font-weight:700;padding:0;line-height:1;border:1px solid var(--c-border);border-radius:var(--border-radius-sm);background-color:var(--c-surface);color:var(--c-text);opacity:.6}.accidental-button.active{background-color:var(--c-warning);color:var(--c-text);opacity:1}.accidental-button:not(.active):hover{background-color:var(--c-border)}.toggle-button-group,.macrobeat-adjust-group{display:flex;gap:var(--space-1);justify-content:center}.sidebar-toggle-button{flex:1;padding:var(--space-2);text-align:center;background-color:var(--c-surface);color:var(--c-text-muted);border:1px solid var(--c-border)}.sidebar-toggle-button.active{background-color:var(--c-accent);color:var(--c-surface);border-color:var(--c-accent-hover)}.sidebar-toggle-button:not(.active):hover{background-color:var(--c-border)}.dropdown-container{position:relative;display:inline-block}.dropdown-container.open{z-index:10}.tonic-dropdown-toggle,.degree-dropdown-toggle{display:flex;align-items:center;gap:var(--space-2);justify-content:center;background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border)}.tonic-dropdown-toggle{padding:var(--space-1) var(--space-2)}.dropdown-arrow{font-size:10px;transition:transform .2s ease}.dropdown-container.open .dropdown-arrow{transform:rotate(180deg)}.dropdown-menu{display:none;position:absolute;top:100%;left:50%;transform:translate(-50%);background-color:var(--c-surface);border:1px solid var(--c-border);border-radius:var(--border-radius-md);box-shadow:var(--box-shadow-md);z-index:100;padding:var(--space-1);flex-direction:column;gap:var(--space-1);margin-top:var(--space-1);max-height:80vh;overflow-y:auto;white-space:nowrap;width:max-content}.dropdown-container.open .dropdown-menu{display:flex}.tonic-sign-button{background:transparent;border:none;padding:var(--space-1);display:flex;align-items:center;gap:var(--space-2);white-space:nowrap}.tonic-sign-button:hover{background-color:var(--c-border)}.mode-label{font-size:12px;color:var(--c-text-muted);font-weight:400}.tonic-shape-icon{width:28px;height:28px;object-fit:contain;display:block}.dropdown-menu .tonic-shape-icon{width:32px;height:32px}.tonic-dropdown-toggle.selected,#degree-dropdown-menu .toolkit-button.active{border-color:var(--c-accent);box-shadow:0 0 5px var(--c-accent)}.harmony-preset-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:var(--space-1);flex:1}.harmony-preset-button{background-color:var(--c-surface);color:var(--c-text);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);font-size:18px;font-weight:700;min-height:40px}.harmony-preset-button:hover{background-color:var(--c-border)}.harmony-preset-button.selected{background-color:var(--c-accent);color:var(--c-surface);border-color:var(--c-accent-hover)}#note-bank-container{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--space-2)}.note-bank-row{display:flex;flex-direction:row;gap:var(--space-2)}.note-pair{display:flex;flex-direction:row;align-items:center;gap:var(--space-1);padding:3px;border-radius:var(--border-radius-md);border:2px solid transparent}.note{width:var(--note-size);height:var(--note-size);margin:0;cursor:pointer;border-radius:50%;transition:all .2s;background-color:transparent;border:4px solid var(--note-color)}.note:hover{transform:scale(1.1)}.oval-note{width:calc(var(--note-size) * .7)}.note-pair[data-color="#4a90e2"] .note{--note-color: #4a90e2}.note-pair[data-color="#2d2d2d"] .note{--note-color: #2d2d2d}.note-pair[data-color="#d66573"] .note{--note-color: #d66573}.note-pair[data-color="#68a03f"] .note{--note-color: #68a03f}.eraser-icon{width:24px;height:24px;object-fit:contain}.tempo-row{display:flex;justify-content:center;gap:.5em;background-color:transparent;border:none;padding:var(--space-2);border-radius:0}.tempo-slider-row{background-color:transparent;border:none;padding:var(--space-2);border-radius:0}.tempo-input-group{display:flex;align-items:center;gap:var(--space-2)}.tempo-label-icon{height:1.5rem;width:auto;-webkit-user-select:none;user-select:none}.tempo-input{width:45px;background-color:var(--c-bg);color:var(--c-text);border:1px solid var(--c-border);border-radius:var(--border-radius-sm);text-align:center;font-family:var(--main-font)}.tempo-input::-webkit-outer-spin-button,.tempo-input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}#canvas-macrobeat-tools{position:relative;height:2em;margin-block-end:var(--space-1)}#time-signature-display{height:20px;width:100%;position:relative}.rhythm-ui-button{background-color:#ffffff80;color:var(--c-text);border:1px solid var(--c-border);border-radius:50%;width:20px;height:20px;padding:0;line-height:18px;text-align:center;z-index:10;position:absolute;transform:translate(-50%);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.rhythm-ui-button:hover{background-color:var(--c-surface);border-color:var(--c-text)}.time-signature-label{background:#ffffff80;padding-block:2px;padding-inline:var(--space-2);border-radius:var(--border-radius-sm);font-weight:700;color:var(--c-text-muted);-webkit-user-select:none;user-select:none;position:absolute;transform:translate(-50%);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.time-signature-label.anacrusis-label{color:var(--c-border)}.adsr-container{flex-direction:column;justify-content:flex-start}.adsr-main-panel{display:flex;flex-direction:row;width:100%;flex-grow:1;gap:var(--space-2);min-height:0;overflow:visible}.adsr-graph-wrapper{flex-grow:1;position:relative;border:1px solid var(--c-border);border-radius:var(--border-radius-sm);overflow:visible}#adsr-envelope{width:100%;height:100%;overflow:visible}#adsr-envelope svg{display:block;width:100%;height:100%;background-color:var(--c-surface)}.sustain-slider-wrapper{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-inline:var(--space-1);width:20px}#sustain-slider-track{position:relative;width:var(--space-2);height:100%;background-color:var(--c-gridline);border-radius:var(--border-radius-sm)}#sustain-slider-track:before{content:"";position:absolute;bottom:0;left:0;width:100%;height:var(--sustain-progress, 0%);background-color:var(--c-accent);border-radius:var(--border-radius-sm)}#sustain-slider-thumb{position:absolute;left:50%;transform:translate(-50%,50%);width:20px;height:20px;background-color:var(--c-accent);border-radius:50%;border:2px solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:grab;color:var(--c-surface);font-size:12px;font-weight:700;display:flex;justify-content:center;align-items:center;-webkit-user-select:none;user-select:none}#sustain-slider-thumb:active{cursor:grabbing;background-color:var(--c-accent-hover);transform:translate(-50%,50%) scale(1.1)}#multi-thumb-slider-container{position:relative;width:calc(100% - 30px);height:var(--space-2);border-radius:var(--border-radius-sm);margin-block-start:var(--space-3);align-self:flex-start;background:linear-gradient(to right,var(--c-accent) var(--adr-progress, 0%),var(--c-gridline) var(--adr-progress, 0%))}.time-slider-thumb{position:absolute;top:50%;transform:translate(-50%,-50%);width:20px;height:20px;background-color:var(--c-accent);border-radius:50%;border:2px solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:grab;color:var(--c-surface);font-size:12px;font-weight:700;display:flex;justify-content:center;align-items:center;-webkit-user-select:none;user-select:none}.time-slider-thumb:active{cursor:grabbing;background-color:var(--c-accent-hover);transform:translate(-50%,-50%) scale(1.1)}.harmonic-bins-container{flex-direction:column;justify-content:flex-start}.harmonic-bins-grid{display:flex;flex-direction:row;flex-grow:1;min-height:120px;position:relative;gap:0;padding:0;border:1px solid var(--c-border);border-radius:2px;overflow:hidden}.slider-column{display:flex;flex-direction:column;flex:1;align-items:center;min-width:0}.harmonic-label{font-size:.7rem;color:var(--c-text-muted);text-align:center;margin-bottom:4px;height:16px;display:flex;align-items:center;justify-content:center}.harmonic-label-internal{position:absolute;bottom:2px;left:50%;transform:translate(-50%);font-size:.8rem;font-weight:600;text-align:center;z-index:3;pointer-events:none;transition:color .1s ease,text-shadow .1s ease;-webkit-user-select:none;user-select:none}.slider-track{flex-grow:1;width:100%;background-color:#fff;border:none;border-radius:0;position:relative;cursor:pointer;margin:0;min-height:60px;display:flex;flex-direction:column;justify-content:flex-end}.slider-snap-zone{position:absolute;bottom:0;left:0;right:0;height:10%;background-color:#f7f7f7;border-top:1px solid var(--c-border)}.slider-fill{position:absolute;bottom:0;left:0;right:0;background-color:transparent;transition:height .1s ease;border-radius:0 0 1px 1px}.phase-button{background-color:var(--c-gridline);color:var(--c-text-muted);border:1px solid var(--c-border);border-radius:3px;margin-top:4px;padding:2px;cursor:pointer;display:flex;align-items:center;justify-content:center;width:20px;height:20px;flex-shrink:0}.phase-button:hover{background-color:var(--c-border);color:var(--c-text)}.phase-button svg{width:100%;height:100%}.filter-overlay-canvas{position:absolute;top:0;left:0;width:100%;height:calc(100% - 28px);pointer-events:none;z-index:2}.blend-slider-container{display:flex;align-items:center;width:100%;margin-bottom:var(--space-2);flex-shrink:0}#filter-enable-toggle{flex-shrink:0;background-color:var(--c-gridline);color:var(--c-text-muted);border:1px solid var(--c-border)}#filter-enable-toggle .filter-icon{width:24px;height:24px}#filter-enable-toggle.active{background-color:var(--c-accent);color:var(--c-surface);border-color:var(--c-accent-hover)}#blend-slider-container,#cutoff-slider-container{flex-grow:1;position:relative;height:var(--space-2);border-radius:var(--border-radius-sm);background:linear-gradient(to right,var(--c-accent) var(--progress, 0%),var(--c-gridline) var(--progress, 0%))}.filter-main-panel{display:flex;flex-direction:row;width:100%;flex-grow:1;gap:var(--space-2);min-height:0}.filter-button-wrapper{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-inline:var(--space-1);width:40px;transition:opacity .2s}#cutoff-slider-container{width:100%;height:10px!important;margin-block-start:var(--space-2);align-self:flex-start;transition:opacity .2s;flex-shrink:0}.filter-cutoff-thumb,.filter-blend-thumb{position:absolute;top:50%;transform:translate(-50%,-50%);width:20px;height:20px;font-size:12px;background-color:var(--c-accent);border-radius:50%;border:2px solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:grab;color:var(--c-surface);font-weight:700;display:flex;justify-content:center;align-items:center;-webkit-user-select:none;user-select:none;z-index:5}.filter-cutoff-thumb:active,.filter-blend-thumb:active{cursor:grabbing;background-color:var(--c-accent-hover);transform:translate(-50%,-50%) scale(1.1)}.multislider-container.filter-disabled #blend-slider-container,.multislider-container.filter-disabled #cutoff-slider-container{opacity:.5;pointer-events:none}.vertical-blend-wrapper{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-inline:var(--space-1);width:30px}#vertical-blend-track{position:relative;width:var(--space-2);height:100%;min-height:80px;background:linear-gradient(to top,var(--c-accent) var(--blend-progress, 0%),var(--c-gridline) var(--blend-progress, 0%));border-radius:var(--border-radius-sm);cursor:pointer}#vertical-blend-thumb{position:absolute;left:50%;transform:translate(-50%,50%);width:20px;height:20px;background-color:var(--c-accent);border-radius:50%;border:2px solid var(--c-surface);box-shadow:var(--box-shadow-sm);cursor:ns-resize;color:var(--c-surface);font-size:12px;font-weight:700;display:flex;justify-content:center;align-items:center;-webkit-user-select:none;user-select:none;z-index:5}#vertical-blend-thumb:active{cursor:ns-resize;background-color:var(--c-accent-hover);transform:translate(-50%,50%) scale(1.1)}#filter-enable-toggle,.multislider-container.filter-disabled .filter-overlay-canvas{display:none}#pitch-paint-canvas{position:absolute;top:0;left:0;pointer-events:none;z-index:2}#pitch-paint-container{display:flex;flex-direction:column;gap:var(--space-2)}.paint-layout-grid{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-3);align-items:start}.paint-main-controls{display:flex;flex-direction:column;gap:var(--space-2)}.paint-main-controls>.toolkit-button{flex:1}#mic-paint-toggle.active{background-color:var(--c-danger);color:var(--c-surface);border-color:var(--c-danger);font-weight:700}#paint-clear-btn:disabled{background-color:var(--c-border);opacity:.5;cursor:not-allowed}.paint-settings{display:flex;flex-direction:column;gap:var(--space-2);margin-top:0;padding-top:0;border-top:none}.paint-setting-group{display:flex;flex-direction:column;gap:var(--space-1)}.paint-setting-group label{font-size:var(--font-size-sm);color:var(--c-text-muted);font-weight:500}.paint-setting-group .slider-wrapper{display:flex;align-items:center;gap:var(--space-2)}.paint-slider{width:100%;height:6px;border-radius:var(--border-radius-sm);background:var(--c-gridline);outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;flex-grow:1}.paint-slider::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;background:var(--c-accent);border:2px solid var(--c-surface);cursor:pointer;box-shadow:var(--box-shadow-sm)}.paint-slider::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:var(--c-accent);border:2px solid var(--c-surface);cursor:pointer;box-shadow:var(--box-shadow-sm)}.paint-setting-group .slider-wrapper span{font-size:var(--font-size-sm);color:var(--c-text);background-color:var(--c-gridline);padding:var(--space-1) var(--space-2);border-radius:var(--border-radius-sm);min-width:45px;text-align:center}.note.selected{background-color:var(--note-color, #000)}.note-pair.selected{border-color:var(--note-color)!important;box-shadow:0 0 8px var(--note-color)}.note-pair[data-color="#4a90e2"].selected{--note-color: #4a90e2}.note-pair[data-color="#2d2d2d"].selected{--note-color: #2d2d2d}.note-pair[data-color="#d66573"].selected{--note-color: #d66573}.note-pair[data-color="#68a03f"].selected{--note-color: #68a03f}.toolkit-icon-button.selected,.toolkit-icon-button.active:not(#grid-zoom-in):not(#grid-zoom-out):not(#clear-button):not(#undo-button):not(#redo-button):not(#stop-button):not(#play-button){background-color:var(--c-accent);color:var(--c-surface)}.toolkit-icon-button.selected img,.toolkit-icon-button.active:not(#grid-zoom-in):not(#grid-zoom-out):not(#clear-button):not(#undo-button):not(#redo-button):not(#stop-button):not(#play-button) img{filter:invert(1) brightness(2)}.eraser-button.selected{background-color:var(--c-danger);color:var(--c-surface);box-shadow:none}.eraser-button.selected img{filter:invert(1) brightness(2)}.toolkit-icon-button.selected:hover,.toolkit-icon-button.active:hover{background-color:var(--c-accent-hover);transform:scale(1)}.eraser-button.selected:hover{background-color:#a72836}.eraser-button.erasing-active{background-color:var(--c-danger);color:var(--c-surface);transform:scale(1)}.eraser-button.erasing-active img{filter:invert(1) brightness(2)}.toolkit-icon-button.flash{background-color:#dc35454d;box-shadow:0 0 8px var(--c-danger);animation:clearFlash .3s ease-out}@keyframes clearFlash{0%{background-color:#dc354599;box-shadow:0 0 12px var(--c-danger)}to{background-color:transparent;box-shadow:none}}.preset-button.selected{background-color:var(--c-accent);color:var(--c-surface);border:1px solid var(--c-accent-hover);box-shadow:0 0 5px var(--c-accent)}.preset-button.selected:hover{background-color:var(--c-accent-hover)}.static-waveform-container{margin-bottom:.52em}.static-waveform-container h4{margin:0;font-size:.875rem;font-weight:600;color:var(--c-text, #212529)}.waveform-display-wrapper{position:relative;width:100%;height:100%;border:1px solid var(--c-border, #dee2e6);border-radius:6px;background:var(--c-surface, #ffffff);overflow:hidden;box-shadow:inset 0 1px 3px #0000001a;transition:all .2s ease;transform:translateZ(0)}.waveform-display-wrapper.live-mode{border-color:var(--c-accent, #4A90E2);box-shadow:inset 0 1px 3px #0000001a,0 0 0 2px #4a90e21a}#static-waveform-canvas{display:block;width:100%;height:100%;cursor:default}.waveform-display-wrapper:after{content:"";position:absolute;top:6px;right:6px;width:8px;height:8px;border-radius:50%;background:#28a745;opacity:0;transition:opacity .3s ease;z-index:10}.waveform-display-wrapper.live-mode:after{opacity:1}.timbre-panel .static-waveform-container{margin:0}@keyframes waveform-pulse{0%,to{box-shadow:inset 0 1px 3px #0000001a,0 0 0 2px #4a90e21a}50%{box-shadow:inset 0 1px 3px #0000001a,0 0 0 2px #4a90e233}}.waveform-display-wrapper.live-mode.pulsing{animation:waveform-pulse 2s ease-in-out infinite}@media (max-width: 768px){.waveform-display-wrapper{height:80px}.static-waveform-container h4{font-size:.8rem}}@media (prefers-color-scheme: dark){.waveform-display-wrapper{background:var(--c-surface-dark, #2d3748);border-color:var(--c-border-dark, #4a5568)}.static-waveform-container h4{color:var(--c-text-dark, #e2e8f0)}.waveform-display-wrapper.live-mode{border-color:var(--c-accent, #4A90E2);box-shadow:inset 0 1px 3px #0003,0 0 0 2px #4a90e226}}.static-waveform-container .control-section{padding:0}#timbre-panel .static-waveform-container{border-top:1px solid var(--c-border-light, #f1f3f4);border-bottom:1px solid var(--c-border-light, #f1f3f4);padding-top:0rem;padding-bottom:0;margin-top:.2rem;margin-bottom:.2rem}.waveform-display-wrapper:not(.live-mode){background-image:linear-gradient(90deg,rgba(0,0,0,.02) 1px,transparent 1px),linear-gradient(rgba(0,0,0,.02) 1px,transparent 1px);background-size:20px 10px;background-position:0 0,0 0}.waveform-display-wrapper *{transition:opacity .2s ease}#static-waveform-canvas.loading{opacity:.5;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:loading-shimmer 1.5s infinite}@keyframes loading-shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}@media (prefers-contrast: high){.waveform-display-wrapper{border-width:2px;border-color:#000}.waveform-display-wrapper.live-mode{border-color:#06c;box-shadow:0 0 0 3px #0066cc4d}}@media (prefers-reduced-motion: reduce){.waveform-display-wrapper,.waveform-display-wrapper:after,.waveform-display-wrapper *{transition:none;animation:none}}
